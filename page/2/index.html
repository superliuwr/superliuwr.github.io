<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SUPERLOG</title>
  <meta name="viewport" content="width=device-width">
  <meta property="og:type" content="website">
<meta property="og:title" content="SUPERLOG">
<meta property="og:url" content="http://superliuwr.github.io/page/2/index.html">
<meta property="og:site_name" content="SUPERLOG">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SUPERLOG">
  
    <link rel="alternative" href="/atom.xml" title="SUPERLOG" type="application/atom+xml">
  
  
    <link rel="icon" href="images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">SUPERLOG</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://superliuwr.github.io"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-vue" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/24/vue/" class="article-date">
  <time datetime="2018-06-24T10:47:26.000Z" itemprop="datePublished">2018-06-24</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/24/vue/">Vue.js</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vue/">Vue</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-ruby" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/24/ruby/" class="article-date">
  <time datetime="2018-06-24T10:45:30.000Z" itemprop="datePublished">2018-06-24</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/24/ruby/">Ruby</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><ul>
<li>irb</li>
<li>rvm<ul>
<li>rvm list</li>
<li>rvm list known</li>
<li>rvm install 2.4.2</li>
<li>rvm remove 1.9.2</li>
<li>rvm 2.0.0 –default</li>
</ul>
</li>
<li>gem<ul>
<li>RubyGems is a package manager for the Ruby programming language that provides a standard format for distributing Ruby programs and libraries (in a self-contained format called a “gem”), a tool designed to easily manage the installation of gems, and a server for distributing them. </li>
</ul>
</li>
<li>bundler<ul>
<li>a bunch of gems defined in a file</li>
<li><a href="http://bundler.io/" target="_blank" rel="noopener">http://bundler.io/</a></li>
</ul>
</li>
</ul>
<h1 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is a comment</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 会在程序运行之前被调用</span></span><br><span class="line"><span class="keyword">BEGIN</span> &#123;</span><br><span class="line">   puts <span class="string">"初始化 Ruby 程序"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 会在程序的结尾被调用</span></span><br><span class="line"><span class="keyword">END</span> &#123;</span><br><span class="line">   puts <span class="string">"停止 Ruby 程序"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># In Ruby, (almost) everything is an object.</span></span><br><span class="line"><span class="comment"># This includes numbers…</span></span><br><span class="line"><span class="number">3</span>.<span class="keyword">class</span> <span class="comment">#=&gt; Integer</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># …strings…</span></span><br><span class="line"><span class="string">"Hello"</span>.<span class="keyword">class</span> <span class="comment">#=&gt; String</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># …even methods!</span></span><br><span class="line"><span class="string">"Hello"</span>.method(<span class="symbol">:class</span>).<span class="keyword">class</span> <span class="comment">#=&gt; Method</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Some basic arithmetic</span></span><br><span class="line"><span class="number">1</span> + <span class="number">1</span> <span class="comment">#=&gt; 2</span></span><br><span class="line"><span class="number">8</span> - <span class="number">1</span> <span class="comment">#=&gt; 7</span></span><br><span class="line"><span class="number">10</span> * <span class="number">2</span> <span class="comment">#=&gt; 20</span></span><br><span class="line"><span class="number">35</span> / <span class="number">5</span> <span class="comment">#=&gt; 7</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">5</span> <span class="comment">#=&gt; 32</span></span><br><span class="line"><span class="number">5</span> % <span class="number">3</span> <span class="comment">#=&gt; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Bitwise operators</span></span><br><span class="line"><span class="number">3</span> &amp; <span class="number">5</span> <span class="comment">#=&gt; 1</span></span><br><span class="line"><span class="number">3</span> <span class="params">| 5 #=&gt; 7</span></span><br><span class="line"><span class="params">3 ^ 5 #=&gt; 6</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arithmetic is just syntactic sugar</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> calling a method on an object</span></span><br><span class="line"><span class="params">1.+(3) #=&gt; 4</span></span><br><span class="line"><span class="params">10.* 5 #=&gt; 50</span></span><br><span class="line"><span class="params">100.methods.<span class="keyword">include</span>?(:/) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Special values are objects</span></span><br><span class="line"><span class="params"><span class="literal">nil</span> # equivalent to null <span class="keyword">in</span> other languages</span></span><br><span class="line"><span class="params"><span class="literal">true</span> # truth</span></span><br><span class="line"><span class="params"><span class="literal">false</span> # falsehood</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="literal">nil</span>.<span class="keyword">class</span> #=&gt; NilClass</span></span><br><span class="line"><span class="params"><span class="literal">true</span>.<span class="keyword">class</span> #=&gt; TrueClass</span></span><br><span class="line"><span class="params"><span class="literal">false</span>.<span class="keyword">class</span> #=&gt; FalseClass</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Equality</span></span><br><span class="line"><span class="params">1 == 1 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">2 == 1 #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Inequality</span></span><br><span class="line"><span class="params">1 != 1 #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">2 != 1 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># apart from <span class="literal">false</span> itself, <span class="literal">nil</span> is the only other 'falsey' value</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">!!<span class="literal">nil</span>   #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">!!<span class="literal">false</span> #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">!!0     #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">!!""    #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># More comparisons</span></span><br><span class="line"><span class="params">1 &lt; 10 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">1 &gt; 10 #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">2 &lt;= 2 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">2 &gt;= 2 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Combined comparison operator (returns `1` <span class="keyword">when</span> the first argument is greater, </span></span><br><span class="line"><span class="params"># `-1` <span class="keyword">when</span> the second argument is greater, <span class="keyword">and</span> `0` otherwise)</span></span><br><span class="line"><span class="params">1 &lt;=&gt; 10 #=&gt; -1</span></span><br><span class="line"><span class="params">10 &lt;=&gt; 1 #=&gt; 1</span></span><br><span class="line"><span class="params">1 &lt;=&gt; 1 #=&gt; 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">1 == 1.0 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">1.eql?(1.0) #=&gt; <span class="literal">false</span> 如果接收器和参数具有相同的类型和相等的值，则返回 <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">aObj == bObj #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">a.equal?(bObj) #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">a.equal?(aObj) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Logical operators</span></span><br><span class="line"><span class="params"><span class="literal">true</span> &amp;&amp; <span class="literal">false</span> #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"><span class="literal">true</span> |</span><span class="params">| <span class="literal">false</span> #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">!<span class="literal">true</span> #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># There are alternate versions of the logical operators with much lower</span></span><br><span class="line"><span class="params"># precedence. These are meant to be used as flow-control constructs to chain</span></span><br><span class="line"><span class="params"># statements together <span class="keyword">until</span> one of them returns <span class="literal">true</span> <span class="keyword">or</span> <span class="literal">false</span>.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># `do_something_else` only called <span class="keyword">if</span> `do_something` succeeds.</span></span><br><span class="line"><span class="params">do_something() <span class="keyword">and</span> do_something_else()</span></span><br><span class="line"><span class="params"># `log_error` only called <span class="keyword">if</span> `do_something` fails.</span></span><br><span class="line"><span class="params">do_something() <span class="keyword">or</span> log_error()</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># String interpolation</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">placeholder = 'use string interpolation'</span></span><br><span class="line"><span class="params">"I can #&#123;placeholder&#125; <span class="keyword">when</span> using double quoted strings"</span></span><br><span class="line"><span class="params">#=&gt; "I can use string interpolation <span class="keyword">when</span> using double quoted strings"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># You can combine strings using `+`, but <span class="keyword">not</span> with other types</span></span><br><span class="line"><span class="params">'hello ' + 'world'  #=&gt; "hello world"</span></span><br><span class="line"><span class="params">'hello ' + 3 #=&gt; TypeError: can't convert Fixnum into String</span></span><br><span class="line"><span class="params">'hello ' + 3.to_s #=&gt; "hello 3"</span></span><br><span class="line"><span class="params">"hello #&#123;3&#125;" #=&gt; "hello 3"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Combine strings <span class="keyword">and</span> operators</span></span><br><span class="line"><span class="params">'hello ' * 3 #=&gt; "hello hello hello "</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Append to string</span></span><br><span class="line"><span class="params">'hello' &lt;&lt; ' world' #=&gt; "hello world"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># print to the output with a newline at the <span class="keyword">end</span></span></span><br><span class="line"><span class="params">puts "I'm printing!"</span></span><br><span class="line"><span class="params">#=&gt; I'm printing!</span></span><br><span class="line"><span class="params">#=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># print to the output without a newline</span></span><br><span class="line"><span class="params">print "I'm printing!"</span></span><br><span class="line"><span class="params">#=&gt; I'm printing! =&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># here document</span></span><br><span class="line"><span class="params">print &lt;&lt;EOF</span></span><br><span class="line"><span class="params">    This is how you create a mulitple</span></span><br><span class="line"><span class="params">    line string. Anything inbetween is</span></span><br><span class="line"><span class="params">    part of the string.</span></span><br><span class="line"><span class="params">EOF</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables</span></span><br><span class="line"><span class="params">x = 25 #=&gt; 25</span></span><br><span class="line"><span class="params">x #=&gt; 25</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Note that assignment returns the value assigned</span></span><br><span class="line"><span class="params"># This means you can <span class="keyword">do</span> multiple assignment:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">x = y = 10 #=&gt; 10</span></span><br><span class="line"><span class="params">x #=&gt; 10</span></span><br><span class="line"><span class="params">y #=&gt; 10</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">a, b, c = 10, 20, 30</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">a, b = b, c</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># By convention, use snake_case <span class="keyword">for</span> variable names</span></span><br><span class="line"><span class="params">snake_case = <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Use descriptive variable names</span></span><br><span class="line"><span class="params">path_to_project_root = '/good/name/'</span></span><br><span class="line"><span class="params">m = '/bad/name/'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Symbols are immutable, reusable constants represented internally by an</span></span><br><span class="line"><span class="params"># integer value. They're often used instead of strings to efficiently convey</span></span><br><span class="line"><span class="params"># specific, meaningful values</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">:pending.<span class="keyword">class</span> #=&gt; Symbol</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status = :pending</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status == :pending #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status == 'pending' #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status == :approved #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Strings can be converted into symbols <span class="keyword">and</span> vice versa:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status.to_s #=&gt; "pending"</span></span><br><span class="line"><span class="params">"argon".to_sym #=&gt; :argon</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arrays</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># This is an array</span></span><br><span class="line"><span class="params">array = [1, 2, 3, 4, 5] #=&gt; [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arrays can contain different types of items</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">[1, 'hello', <span class="literal">false</span>] #=&gt; [1, "hello", <span class="literal">false</span>]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arrays can be indexed</span></span><br><span class="line"><span class="params"># From the front</span></span><br><span class="line"><span class="params">array[0] #=&gt; 1</span></span><br><span class="line"><span class="params">array.first #=&gt; 1</span></span><br><span class="line"><span class="params">array[12] #=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Like arithmetic, [var] access</span></span><br><span class="line"><span class="params"># is just syntactic sugar</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> calling a method [] on an object</span></span><br><span class="line"><span class="params">array.[] 0 #=&gt; 1</span></span><br><span class="line"><span class="params">array.[] 12 #=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># From the <span class="keyword">end</span></span></span><br><span class="line"><span class="params">array[-1] #=&gt; 5</span></span><br><span class="line"><span class="params">array.last #=&gt; 5</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># With a start index <span class="keyword">and</span> length</span></span><br><span class="line"><span class="params">array[2, 3] #=&gt; [3, 4, 5]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Reverse an Array</span></span><br><span class="line"><span class="params">a = [1,2,3]</span></span><br><span class="line"><span class="params">a.reverse! #=&gt; [3,2,1]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Or with a range</span></span><br><span class="line"><span class="params">array[1..3] #=&gt; [2, 3, 4]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Add to an array like this</span></span><br><span class="line"><span class="params">array &lt;&lt; 6 #=&gt; [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="params"># Or like this</span></span><br><span class="line"><span class="params">array.push(6) #=&gt; [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Check <span class="keyword">if</span> an item exists <span class="keyword">in</span> an array</span></span><br><span class="line"><span class="params">array.<span class="keyword">include</span>?(1) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Hashes are Ruby's primary dictionary with key/value pairs.</span></span><br><span class="line"><span class="params"># Hashes are denoted with curly braces:</span></span><br><span class="line"><span class="params">hash = &#123; 'color' =&gt; 'green', 'number' =&gt; 5 &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">hash.keys #=&gt; ['color', 'number']</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Hashes can be quickly looked up by key:</span></span><br><span class="line"><span class="params">hash['color'] #=&gt; 'green'</span></span><br><span class="line"><span class="params">hash['number'] #=&gt; 5</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Asking a hash <span class="keyword">for</span> a key that doesn't exist returns <span class="literal">nil</span>:</span></span><br><span class="line"><span class="params">hash['nothing here'] #=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># When using symbols <span class="keyword">for</span> keys <span class="keyword">in</span> a hash, you can use this alternate syntax:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">new_hash = &#123; defcon: 3, action: <span class="literal">true</span> &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">new_hash.keys #=&gt; [:defcon, :action]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Check existence of keys <span class="keyword">and</span> values <span class="keyword">in</span> hash</span></span><br><span class="line"><span class="params">new_hash.key?(:defcon) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">new_hash.value?(3) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Tip: Both Arrays <span class="keyword">and</span> Hashes are Enumerable</span></span><br><span class="line"><span class="params"># They share a lot of useful methods such as each, map, count, <span class="keyword">and</span> more</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Control structures</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">if</span> <span class="literal">true</span></span></span><br><span class="line"><span class="params">  '<span class="keyword">if</span> statement'</span></span><br><span class="line"><span class="params"><span class="keyword">elsif</span> <span class="literal">false</span></span></span><br><span class="line"><span class="params">  '<span class="keyword">else</span> <span class="keyword">if</span>, optional'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  '<span class="keyword">else</span>, also optional'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># In Ruby, traditional `<span class="keyword">for</span>` loops aren't very common. Instead, these </span></span><br><span class="line"><span class="params"># basic loops are implemented using enumerable, which hinges on `each`:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">(1..5).each <span class="keyword">do</span> |</span>counter<span class="params">|</span></span><br><span class="line"><span class="params">  puts "iteration #&#123;counter&#125;"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Which is roughly equivalent to this, which is unusual to see <span class="keyword">in</span> Ruby:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">for</span> counter <span class="keyword">in</span> 1..5</span></span><br><span class="line"><span class="params">  puts "iteration #&#123;counter&#125;"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The `<span class="keyword">do</span> |</span>variable<span class="params">| ... <span class="keyword">end</span>` construct above is called a “block”. Blocks are similar</span></span><br><span class="line"><span class="params"># to lambdas, anonymous functions <span class="keyword">or</span> closures <span class="keyword">in</span> other programming languages. They can</span></span><br><span class="line"><span class="params"># be passed around as objects, called, <span class="keyword">or</span> attached as methods. </span></span><br><span class="line"><span class="params">#</span></span><br><span class="line"><span class="params"># The "each" method of a range runs the block once <span class="keyword">for</span> each element of the range.</span></span><br><span class="line"><span class="params"># The block is passed a counter as a parameter.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># You can also surround blocks <span class="keyword">in</span> curly brackets:</span></span><br><span class="line"><span class="params">(1..5).each &#123; |</span>counter<span class="params">| puts "iteration #&#123;counter&#125;" &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The contents of data structures can also be iterated using each.</span></span><br><span class="line"><span class="params">array.each <span class="keyword">do</span> |</span>element<span class="params">|</span></span><br><span class="line"><span class="params">  puts "#&#123;element&#125; is part of the array"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">hash.each <span class="keyword">do</span> |</span>key, value<span class="params">|</span></span><br><span class="line"><span class="params">  puts "#&#123;key&#125; is #&#123;value&#125;"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># If you still need an index you can use "each_with_index" <span class="keyword">and</span> define an index</span></span><br><span class="line"><span class="params"># variable</span></span><br><span class="line"><span class="params">array.each_with_index <span class="keyword">do</span> |</span>element, index<span class="params">|</span></span><br><span class="line"><span class="params">  puts "#&#123;element&#125; is number #&#123;index&#125; <span class="keyword">in</span> the array"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">counter = 1</span></span><br><span class="line"><span class="params"><span class="keyword">while</span> counter &lt;= 5 <span class="keyword">do</span></span></span><br><span class="line"><span class="params">  puts "iteration #&#123;counter&#125;"</span></span><br><span class="line"><span class="params">  counter += 1</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">#=&gt; iteration 1</span></span><br><span class="line"><span class="params">#=&gt; iteration 2</span></span><br><span class="line"><span class="params">#=&gt; iteration 3</span></span><br><span class="line"><span class="params">#=&gt; iteration 4</span></span><br><span class="line"><span class="params">#=&gt; iteration 5</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># There are a bunch of other helpful looping functions <span class="keyword">in</span> Ruby,</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> example "map", "reduce", "inject", the list goes on. Map,</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> instance, takes the array it's looping over, does something</span></span><br><span class="line"><span class="params"># to it as <span class="keyword">defined</span> <span class="keyword">in</span> your block, <span class="keyword">and</span> returns an entirely new array.</span></span><br><span class="line"><span class="params">array = [1,2,3,4,5]</span></span><br><span class="line"><span class="params">doubled = array.map <span class="keyword">do</span> |</span>element<span class="params">|</span></span><br><span class="line"><span class="params">  element * 2</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">puts doubled</span></span><br><span class="line"><span class="params">#=&gt; [2,4,6,8,10]</span></span><br><span class="line"><span class="params">puts array</span></span><br><span class="line"><span class="params">#=&gt; [1,2,3,4,5]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">grade = 'B'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">case</span> grade</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'A'</span></span><br><span class="line"><span class="params">  puts 'Way to go kiddo'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'B'</span></span><br><span class="line"><span class="params">  puts 'Better luck <span class="keyword">next</span> time'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'C'</span></span><br><span class="line"><span class="params">  puts 'You can <span class="keyword">do</span> better'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'D'</span></span><br><span class="line"><span class="params">  puts 'Scraping through'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'F'</span></span><br><span class="line"><span class="params">  puts 'You failed!'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  puts 'Alternative grading system, eh?'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">#=&gt; "Better luck <span class="keyword">next</span> time"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># cases can also use ranges</span></span><br><span class="line"><span class="params">grade = 82</span></span><br><span class="line"><span class="params"><span class="keyword">case</span> grade</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 90..100</span></span><br><span class="line"><span class="params">  puts 'Hooray!'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 80...90</span></span><br><span class="line"><span class="params">  puts 'OK job'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  puts 'You failed!'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">#=&gt; "OK job"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># exception handling:</span></span><br><span class="line"><span class="params"><span class="keyword">begin</span></span></span><br><span class="line"><span class="params">  # code here that might raise an exception</span></span><br><span class="line"><span class="params">  raise NoMemoryError, 'You ran out of memory.'</span></span><br><span class="line"><span class="params"><span class="keyword">rescue</span> NoMemoryError =&gt; exception_variable</span></span><br><span class="line"><span class="params">  puts 'NoMemoryError was raised', exception_variable</span></span><br><span class="line"><span class="params"><span class="keyword">rescue</span> RuntimeError =&gt; other_exception_variable</span></span><br><span class="line"><span class="params">  puts 'RuntimeError was raised now'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  puts 'This runs <span class="keyword">if</span> no exceptions were thrown at all'</span></span><br><span class="line"><span class="params"><span class="keyword">ensure</span></span></span><br><span class="line"><span class="params">  puts 'This code always runs no matter what'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Methods</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def double(x)</span></span><br><span class="line"><span class="params">  x * 2</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Methods (<span class="keyword">and</span> blocks) implicitly <span class="keyword">return</span> the value of the last statement</span></span><br><span class="line"><span class="params">double(2) #=&gt; 4</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Parentheses are optional where the interpretation is unambiguous</span></span><br><span class="line"><span class="params">double 3 #=&gt; 6</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">double double 3 #=&gt; 12</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def sum(x, y)</span></span><br><span class="line"><span class="params">  x + y</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Method arguments are separated by a comma</span></span><br><span class="line"><span class="params">sum 3, 4 #=&gt; 7</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">sum sum(3, 4), 5 #=&gt; 12</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># <span class="keyword">yield</span></span></span><br><span class="line"><span class="params"># All methods have an implicit, optional block parameter</span></span><br><span class="line"><span class="params"># it can be called with the '<span class="keyword">yield</span>' keyword</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def surround</span></span><br><span class="line"><span class="params">  puts '&#123;'</span></span><br><span class="line"><span class="params">  <span class="keyword">yield</span></span></span><br><span class="line"><span class="params">  puts '&#125;'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">surround &#123; puts 'hello world' &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># &#123;</span></span><br><span class="line"><span class="params"># hello world</span></span><br><span class="line"><span class="params"># &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Blocks can be converted into a `proc` object, which wraps the block </span></span><br><span class="line"><span class="params"># <span class="keyword">and</span> allows it to be passed to another method, bound to a different scope,</span></span><br><span class="line"><span class="params"># <span class="keyword">or</span> manipulated otherwise. This is most common <span class="keyword">in</span> method parameter lists,</span></span><br><span class="line"><span class="params"># where you frequently see a trailing `&amp;block` parameter that will accept </span></span><br><span class="line"><span class="params"># the block, <span class="keyword">if</span> one is given, <span class="keyword">and</span> convert it to a `Proc`. The naming here is</span></span><br><span class="line"><span class="params"># convention; it would work just as well with `&amp;pineapple`:</span></span><br><span class="line"><span class="params">def guests(&amp;block)</span></span><br><span class="line"><span class="params">  block.<span class="keyword">class</span> #=&gt; Proc</span></span><br><span class="line"><span class="params">  block.call(4)</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The `call` method on the Proc is similar to calling `<span class="keyword">yield</span>` <span class="keyword">when</span> a block is </span></span><br><span class="line"><span class="params"># present. The arguments passed to `call` will be forwarded to the block as arugments:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">guests &#123; |</span>n<span class="params">| "You have #&#123;n&#125; guests." &#125;</span></span><br><span class="line"><span class="params"># =&gt; "You have 4 guests."</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># You can pass a list of arguments, which will be converted into an array</span></span><br><span class="line"><span class="params"># That's what splat operator ("*") is <span class="keyword">for</span></span></span><br><span class="line"><span class="params">def guests(*array)</span></span><br><span class="line"><span class="params">  array.each &#123; |</span>guest<span class="params">| puts guest &#125;</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Destructuring</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Ruby will automatically destrucure arrays on assignment to multiple variables:</span></span><br><span class="line"><span class="params">a, b, c = [1, 2, 3]</span></span><br><span class="line"><span class="params">a #=&gt; 1</span></span><br><span class="line"><span class="params">b #=&gt; 2</span></span><br><span class="line"><span class="params">c #=&gt; 3</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># In some cases, you will want to use the splat operator: `*` to prompt destructuring</span></span><br><span class="line"><span class="params"># of an array into a list:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">ranked_competitors = ["John", "Sally", "Dingus", "Moe", "Marcy"]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def best(first, second, third)</span></span><br><span class="line"><span class="params">  puts "Winners are #&#123;first&#125;, #&#123;second&#125;, <span class="keyword">and</span> #&#123;third&#125;."</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">best *ranked_competitors.first(3) #=&gt; Winners are John, Sally, <span class="keyword">and</span> Dingus.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The splat operator can also be used <span class="keyword">in</span> parameters:</span></span><br><span class="line"><span class="params">def best(first, second, third, *others)</span></span><br><span class="line"><span class="params">  puts "Winners are #&#123;first&#125;, #&#123;second&#125;, <span class="keyword">and</span> #&#123;third&#125;."</span></span><br><span class="line"><span class="params">  puts "There were #&#123;others.count&#125; other participants."</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">best *ranked_competitors </span></span><br><span class="line"><span class="params">#=&gt; Winners are John, Sally, <span class="keyword">and</span> Dingus.</span></span><br><span class="line"><span class="params">#=&gt; There were 2 other participants.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># By convention, all methods that <span class="keyword">return</span> booleans <span class="keyword">end</span> with a question mark</span></span><br><span class="line"><span class="params">5.even? # <span class="literal">false</span></span></span><br><span class="line"><span class="params">5.odd? # <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># And <span class="keyword">if</span> a method ends with an exclamation mark, it does something destructive</span></span><br><span class="line"><span class="params"># like mutate the receiver. Many methods have a ! version to make a change, <span class="keyword">and</span></span></span><br><span class="line"><span class="params"># a non-! version to just <span class="keyword">return</span> a new changed version</span></span><br><span class="line"><span class="params">company_name = "Dunder Mifflin"</span></span><br><span class="line"><span class="params">company_name.upcase #=&gt; "DUNDER MIFFLIN"</span></span><br><span class="line"><span class="params">company_name #=&gt; "Dunder Mifflin"</span></span><br><span class="line"><span class="params">company_name.upcase! # we're mutating company_name this time!</span></span><br><span class="line"><span class="params">company_name #=&gt; "DUNDER MIFFLIN"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Define a <span class="keyword">class</span> with the <span class="keyword">class</span> keyword</span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Human</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # A <span class="keyword">class</span> variable. It is shared by all instances of this <span class="keyword">class</span>.</span></span><br><span class="line"><span class="params">  @@species = 'H. sapiens'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Basic initializer</span></span><br><span class="line"><span class="params">  def initialize(name, age = 0)</span></span><br><span class="line"><span class="params">    # Assign the argument to the "name" instance variable <span class="keyword">for</span> the instance</span></span><br><span class="line"><span class="params">    @name = name</span></span><br><span class="line"><span class="params">    # If no age given, we will fall back to the default <span class="keyword">in</span> the arguments list.</span></span><br><span class="line"><span class="params">    @age = age</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Basic setter method</span></span><br><span class="line"><span class="params">  def name=(name)</span></span><br><span class="line"><span class="params">    @name = name</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Basic getter method</span></span><br><span class="line"><span class="params">  def name</span></span><br><span class="line"><span class="params">    @name</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # The above functionality can be encapsulated using the <span class="keyword">attr_accessor</span> method as follows</span></span><br><span class="line"><span class="params">  <span class="keyword">attr_accessor</span> :name</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Getter/setter methods can also be created individually like this</span></span><br><span class="line"><span class="params">  <span class="keyword">attr_reader</span> :name</span></span><br><span class="line"><span class="params">  <span class="keyword">attr_writer</span> :name</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # A <span class="keyword">class</span> method uses <span class="keyword">self</span> to distinguish from instance methods.</span></span><br><span class="line"><span class="params">  # It can only be called on the <span class="keyword">class</span>, <span class="keyword">not</span> an instance.</span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.say(msg)</span></span><br><span class="line"><span class="params">    puts msg</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def species</span></span><br><span class="line"><span class="params">    @@species</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Instantiate a <span class="keyword">class</span></span></span><br><span class="line"><span class="params">jim = Human.new('Jim Halpert')</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">dwight = Human.new('Dwight K. Schrute')</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Let's call a couple of methods</span></span><br><span class="line"><span class="params">jim.species #=&gt; "H. sapiens"</span></span><br><span class="line"><span class="params">jim.name #=&gt; "Jim Halpert"</span></span><br><span class="line"><span class="params">jim.name = "Jim Halpert II" #=&gt; "Jim Halpert II"</span></span><br><span class="line"><span class="params">jim.name #=&gt; "Jim Halpert II"</span></span><br><span class="line"><span class="params">dwight.species #=&gt; "H. sapiens"</span></span><br><span class="line"><span class="params">dwight.name #=&gt; "Dwight K. Schrute"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Call the <span class="keyword">class</span> method</span></span><br><span class="line"><span class="params">Human.say('Hi') #=&gt; "Hi"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variable's scopes are <span class="keyword">defined</span> by the way we name them.</span></span><br><span class="line"><span class="params"># Variables that start with $ have global scope</span></span><br><span class="line"><span class="params">$var = "I'm a global var"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? $var #=&gt; "global-variable"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables that start with @ have instance scope</span></span><br><span class="line"><span class="params">@var = "I'm an instance var"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? @var #=&gt; "instance-variable"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables that start with @@ have <span class="keyword">class</span> scope</span></span><br><span class="line"><span class="params">@@var = "I'm a <span class="keyword">class</span> var"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? @@var #=&gt; "<span class="keyword">class</span> variable"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables that start with a capital letter are constants</span></span><br><span class="line"><span class="params">Var = "I'm a constant"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? Var #=&gt; "constant"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Class is also an object <span class="keyword">in</span> ruby. So <span class="keyword">class</span> can have instance variables.</span></span><br><span class="line"><span class="params"># Class variable is shared among the <span class="keyword">class</span> <span class="keyword">and</span> all of its descendants.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># base <span class="keyword">class</span></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Human</span></span><br><span class="line"><span class="params">  @@foo = 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.foo</span></span><br><span class="line"><span class="params">    @@foo</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.foo=(value)</span></span><br><span class="line"><span class="params">    @@foo = value</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># derived <span class="keyword">class</span></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Worker &lt; Human</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Human.foo # 0</span></span><br><span class="line"><span class="params">Worker.foo # 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Human.foo = 2 # 2</span></span><br><span class="line"><span class="params">Worker.foo # 2</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Class instance variable is <span class="keyword">not</span> shared by the <span class="keyword">class</span>'s descendants.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Human</span></span><br><span class="line"><span class="params">  @bar = 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.bar</span></span><br><span class="line"><span class="params">    @bar</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.bar=(value)</span></span><br><span class="line"><span class="params">    @bar = value</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Doctor &lt; Human</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Human.bar # 0</span></span><br><span class="line"><span class="params">Doctor.bar # <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">module</span> ModuleExample</span></span><br><span class="line"><span class="params">  def foo</span></span><br><span class="line"><span class="params">    'foo'</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Including modules binds their methods to the <span class="keyword">class</span> instances</span></span><br><span class="line"><span class="params"># Extending modules binds their methods to the <span class="keyword">class</span> itself</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Person</span></span><br><span class="line"><span class="params">  <span class="keyword">include</span> ModuleExample</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Book</span></span><br><span class="line"><span class="params">  extend ModuleExample</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Person.foo     # =&gt; NoMethodError: undefined method `foo' <span class="keyword">for</span> Person:Class</span></span><br><span class="line"><span class="params">Person.new.foo # =&gt; 'foo'</span></span><br><span class="line"><span class="params">Book.foo       # =&gt; 'foo'</span></span><br><span class="line"><span class="params">Book.new.foo   # =&gt; NoMethodError: undefined method `foo'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Callbacks are executed <span class="keyword">when</span> including <span class="keyword">and</span> extending a <span class="keyword">module</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">module</span> ConcernExample</span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.included(base)</span></span><br><span class="line"><span class="params">    base.extend(ClassMethods)</span></span><br><span class="line"><span class="params">    base.send(:<span class="keyword">include</span>, InstanceMethods)</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  <span class="keyword">module</span> ClassMethods</span></span><br><span class="line"><span class="params">    def bar</span></span><br><span class="line"><span class="params">      'bar'</span></span><br><span class="line"><span class="params">    <span class="keyword">end</span></span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  <span class="keyword">module</span> InstanceMethods</span></span><br><span class="line"><span class="params">    def qux</span></span><br><span class="line"><span class="params">      'qux'</span></span><br><span class="line"><span class="params">    <span class="keyword">end</span></span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Something</span></span><br><span class="line"><span class="params">  <span class="keyword">include</span> ConcernExample</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Something.bar     # =&gt; 'bar'</span></span><br><span class="line"><span class="params">Something.qux     # =&gt; NoMethodError: undefined method `qux'</span></span><br><span class="line"><span class="params">Something.new.bar # =&gt; NoMethodError: undefined method `bar'</span></span><br><span class="line"><span class="params">Something.new.qux # =&gt; 'qux'</span></span><br></pre></td></tr></table></figure>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://learnxinyminutes.com/docs/ruby/" target="_blank" rel="noopener">Learn X in Y minutes</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/RoR/">RoR</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-ruby-on-rails" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/23/ruby-on-rails/" class="article-date">
  <time datetime="2018-06-23T12:56:16.000Z" itemprop="datePublished">2018-06-23</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/23/ruby-on-rails/">Ruby on Rails</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h2 id="Development-Environment"><a href="#Development-Environment" class="headerlink" title="Development Environment"></a>Development Environment</h2><p>Follow <a href="https://ruby-china.org/wiki/install_ruby_guide" target="_blank" rel="noopener">this</a> guide.</p>
<h2 id="Philosohpy"><a href="#Philosohpy" class="headerlink" title="Philosohpy"></a>Philosohpy</h2><h3 id="Don’t-repeat-yourself"><a href="#Don’t-repeat-yourself" class="headerlink" title="Don’t repeat yourself"></a>Don’t repeat yourself</h3><h3 id="Convention-over-Configuration"><a href="#Convention-over-Configuration" class="headerlink" title="Convention over Configuration"></a>Convention over Configuration</h3><h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><ul>
<li>Model: 操作数据库</li>
<li>Controller: 把每个 http request 分发到对应的 Action( method) 来处理</li>
<li>View: 显示页面</li>
</ul>
<h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><p>config/routes.rb: <code>resources :users</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET  /users         index     显示 user的列表页</span><br><span class="line">GET  /users/new     new       显示 user的新建页面。</span><br><span class="line">GET  /users/3       show      显示id是3的user</span><br><span class="line">GET  /users/3/edit  edit      显示 user(id =3)的编辑页面。</span><br><span class="line">PUT  /users/3       update    对id = 3的user进行修改 （后面还会紧跟一大串的参数)</span><br><span class="line">POST /users         create    对users进行创建（后面也有一大堆参数)</span><br><span class="line">DELETE  /users/3    destroy   对 id=3的 user 进行删除操作。</span><br></pre></td></tr></table></figure>
<p>可以使用<code>$ rake routes</code>查看当前项目中所有的路由</p>
<h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><h3 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h3><h2 id="Database-Migration"><a href="#Database-Migration" class="headerlink" title="Database Migration"></a>Database Migration</h2>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/RoR/">RoR</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rails/">Rails</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-aws-networking" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/21/aws-networking/" class="article-date">
  <time datetime="2018-06-21T12:08:26.000Z" itemprop="datePublished">2018-06-21</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/21/aws-networking/">aws-networking</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Virtual-Private-Network-VPC"><a href="#Virtual-Private-Network-VPC" class="headerlink" title="Virtual Private Network (VPC)"></a>Virtual Private Network (VPC)</h1><p>Within a region, you can create multiple Amazon VPCs, and each Amazon VPC is logically isolated even if it shares its IP address space.</p>
<p>When you create an Amazon VPC, you must specify the IPv4 address range by choosing a Classless Inter-Domain Routing (CIDR) block, such as 10.0.0.0/16. The address range of the Amazon VPC cannot be changed after the Amazon VPC is created. An Amazon VPC address range may be as large as /16 (65,536 available addresses) or as small as /28 (16 available addresses) and should not overlap any other network with which they are to be connected.</p>
<p>AWS accounts that support EC2-VPC will have a default VPC created in each region with a default subnet created in each Availability Zone. The assigned CIDR block of the VPC will be 172.31.0.0/16.</p>
<p>An Amazon VPC consists of the following components:</p>
<ul>
<li>Subnets</li>
<li>Route tables</li>
<li>Dynamic Host Configuration Protocol (DHCP) option sets</li>
<li>Security groups</li>
<li>Network Access Control Lists (ACLs)</li>
</ul>
<p>An Amazon VPC has the following optional components:</p>
<ul>
<li>Internet Gateways (IGWs)</li>
<li>Elastic IP (EIP) addresses</li>
<li>Elastic Network Interfaces (ENIs)</li>
<li>Endpoints</li>
<li>Peering</li>
<li>Network Address Translation (NATs) instances and NAT gateways</li>
<li>Virtual Private Gateway (VPG), Customer Gateways (CGWs), and Virtual Private Networks (VPNs)</li>
</ul>
<h2 id="Subnets"><a href="#Subnets" class="headerlink" title="Subnets"></a>Subnets</h2><p>CIDR blocks define subnets (for example, 10.0.1.0/24 and 192.168.0.0/24). The smallest subnet that you can create is a /28 (16 IP addresses). AWS reserves the first four IP addresses and the last IP address of every subnet for internal networking purposes.</p>
<p>Subnets reside within one Availability Zone and cannot span zones. You can, however, have multiple subnets in one Availability Zone.</p>
<p><img src="vpc1.jpg" alt=""></p>
<p>Subnets can be classified as public, private, or VPN-only.</p>
<ul>
<li>A public subnet is one in which the associated route table directs the subnet’s traffic to the Amazon VPC’s IGW.</li>
<li>A private subnet is one in which the associated route table does not direct the subnet’s traffic to the Amazon VPC’s IGW.</li>
<li>A VPN-only subnet is one in which the associated route table directs the subnet’s traffic to the Amazon VPC’s VPG and does not have a route to the IGW.</li>
</ul>
<p>Regardless of the type of subnet, the internal IP address range of the subnet is always private (that is, non-routable on the Internet).</p>
<p>Default Amazon VPCs contain one public subnet in every Availability Zone within the region, with a netmask of /20.</p>
<h2 id="Route-Tables"><a href="#Route-Tables" class="headerlink" title="Route Tables"></a>Route Tables</h2><p>A route table is a logical construct within an Amazon VPC that contains a set of rules (called routes) that are applied to the subnet and used to determine where network traffic is directed.</p>
<p>Each route table contains a default route called the local route, which enables communication within the Amazon VPC, and this route cannot be modified or removed. Additional routes can be added to direct traffic to exit the Amazon VPC via the IGW, the VPG, or the NAT instance.</p>
<p>You should remember the following points about route tables:</p>
<ul>
<li>Your VPC has an implicit router.</li>
<li>Your VPC automatically comes with a main route table that you can modify.</li>
<li>You can create additional custom route tables for your VPC.</li>
<li>Each subnet must be associated with a route table, which controls the routing for the subnet. If you don’t explicitly associate a subnet with a particular route table, the subnet uses the main route table.</li>
<li>You can replace the main route table with a custom table that you’ve created so that each new subnet is automatically associated with it.</li>
<li>Each route in a table specifies a destination CIDR and a target; for example, traffic destined for 172.16.0.0/12 is targeted for the VPG. AWS uses the most specific route that matches the traffic to determine how to route the traffic.</li>
</ul>
<h2 id="Internet-Gateways"><a href="#Internet-Gateways" class="headerlink" title="Internet Gateways"></a>Internet Gateways</h2><p>An Internet Gateway (IGW) is a horizontally scaled, redundant, and highly available Amazon VPC component that allows communication between instances in your Amazon VPC and the Internet. An IGW provides a target in your Amazon VPC route tables for Internet-routable traffic, and it performs network address translation for instances that have been assigned public IP addresses.</p>
<p>You must do the following to create a public subnet with Internet access:</p>
<ul>
<li>Attach an IGW to your Amazon VPC.</li>
<li>Create a subnet route table rule to send all non-local traffic (0.0.0.0/0) to the IGW.</li>
<li>Configure your network ACLs and security group rules to allow relevant traffic to flow to and from your instance.</li>
</ul>
<p>You must do the following to enable an Amazon EC2 instance to send and receive traffic from the Internet:</p>
<ul>
<li>Assign a public IP address or EIP address.</li>
<li>You can scope the route to all destinations not explicitly known to the route table (0.0.0.0/0), or you can scope the route to a narrower range of IP addresses, such as the public IP addresses of your company’s public endpoints outside of AWS or the EIP addresses of other Amazon EC2 instances outside your Amazon VPC.</li>
</ul>
<p><img src="vpc2.jpg" alt=""></p>
<h2 id="Dynamic-Host-Configuration-Protocol-DHCP-Option-Sets"><a href="#Dynamic-Host-Configuration-Protocol-DHCP-Option-Sets" class="headerlink" title="Dynamic Host Configuration Protocol (DHCP) Option Sets"></a>Dynamic Host Configuration Protocol (DHCP) Option Sets</h2><h2 id="Elastic-IP-Addresses-EIPs"><a href="#Elastic-IP-Addresses-EIPs" class="headerlink" title="Elastic IP Addresses (EIPs)"></a>Elastic IP Addresses (EIPs)</h2><h2 id="Elastic-Network-Interfaces-ENIs"><a href="#Elastic-Network-Interfaces-ENIs" class="headerlink" title="Elastic Network Interfaces (ENIs)"></a>Elastic Network Interfaces (ENIs)</h2><h2 id="Endpoints"><a href="#Endpoints" class="headerlink" title="Endpoints"></a>Endpoints</h2><h2 id="Peering"><a href="#Peering" class="headerlink" title="Peering"></a>Peering</h2><h2 id="Security-Groups"><a href="#Security-Groups" class="headerlink" title="Security Groups"></a>Security Groups</h2><h2 id="Network-Access-Control-Lists-ACLs"><a href="#Network-Access-Control-Lists-ACLs" class="headerlink" title="Network Access Control Lists (ACLs)"></a>Network Access Control Lists (ACLs)</h2><h2 id="Network-Address-Translation-NAT-Instances-and-NAT-Gateways"><a href="#Network-Address-Translation-NAT-Instances-and-NAT-Gateways" class="headerlink" title="Network Address Translation (NAT) Instances and NAT Gateways"></a>Network Address Translation (NAT) Instances and NAT Gateways</h2><h3 id="NAT-INSTANCE"><a href="#NAT-INSTANCE" class="headerlink" title="NAT INSTANCE"></a>NAT INSTANCE</h3><h3 id="NAT-GATEWAY"><a href="#NAT-GATEWAY" class="headerlink" title="NAT GATEWAY"></a>NAT GATEWAY</h3><h2 id="Virtual-Private-Gateways-VPGs-Customer-Gateways-CGWs-and-Virtual-Private-Networks-VPNs"><a href="#Virtual-Private-Gateways-VPGs-Customer-Gateways-CGWs-and-Virtual-Private-Networks-VPNs" class="headerlink" title="Virtual Private Gateways (VPGs), Customer Gateways (CGWs), and Virtual Private Networks (VPNs)"></a>Virtual Private Gateways (VPGs), Customer Gateways (CGWs), and Virtual Private Networks (VPNs)</h2>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Cloud/">Cloud</a>»<a class="article-category-link" href="/categories/Cloud/DevOps/">DevOps</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AWS/">AWS</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-debug-javascript-typescript" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/20/debug-javascript-typescript/" class="article-date">
  <time datetime="2018-06-20T12:34:22.000Z" itemprop="datePublished">2018-06-20</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/20/debug-javascript-typescript/">Debug Javascript/TypeScript</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="JavaScript-TypeScript-Debugging"><a href="#JavaScript-TypeScript-Debugging" class="headerlink" title="JavaScript/TypeScript Debugging"></a>JavaScript/TypeScript Debugging</h1><p>Node.js 6.3 introduced the “inspect” and “inspect-brk” CLI arguments that make node to listen via WebSockets for diagnostic commands as defined by the Chrome Debugging Protocol.</p>
<p>Additionally, the Node CLI also provides a “require” argument meant to preload modules (node –require [file]), but most importantly, for debugging purposes, it allows 3rd party libraries to hook into the “require.extensions” module and make Node able to compile and generate source-maps for other languages like TypeScript. For debugging TypeScript we’ll use ts-node. It’s important to remember that in your tsconfig.file , that can be generated by running tsc –init , you should have “sourceMap”: true , which is the default value.</p>
<p>When a Node.js app is started in “inspect” mode, 2 important things will happen:</p>
<ul>
<li>An UUID will be assigned to this debugging session and a WebSockets end-point will spin up at ws://127.0.0.1:9229/[UUID] . This end-point will stream real-time events with the current state of the running code.</li>
<li>An HTTP end-point will spin up at <a href="http://127.0.0.1:9229/json" target="_blank" rel="noopener">http://127.0.0.1:9229/json</a> . This allows agents like the Chrome DevTools to know about every running Node session and their respectiveUUID .</li>
</ul>
<h2 id="With-Chrome-DevTools-for-JavaScript"><a href="#With-Chrome-DevTools-for-JavaScript" class="headerlink" title="With Chrome DevTools for JavaScript"></a>With Chrome DevTools for JavaScript</h2><p>To start application in debug mode:</p>
<ul>
<li><code>node --inspect app.js</code></li>
<li><code>node --inspect-brk=9229 app.js</code> - set debug port to 9229 and add a breakpoint at the first line</li>
</ul>
<p>A Node.js process started without –inspect can also be instructed to start listening for debugging messages:</p>
<ul>
<li><code>node -e &#39;process._debugProcess(30464)&#39;</code> - to attach debugger to a running application(not in inspect mode)</li>
<li><code>kill -SIGUSR1 30464</code></li>
</ul>
<p>Debug in Chrome:</p>
<ul>
<li><code>chrome://inspect</code></li>
<li><code>about:inspect</code></li>
<li><code>Cmd + P</code> to navigate to desired file</li>
</ul>
<h2 id="With-Chrome-DevTools-for-TypeScript"><a href="#With-Chrome-DevTools-for-TypeScript" class="headerlink" title="With Chrome DevTools for TypeScript"></a>With Chrome DevTools for TypeScript</h2><p>Start application with <code>node --inspect --require ts-node/register index.ts</code> and it is the same after that.</p>
<h2 id="With-VSC-for-JavaScript"><a href="#With-VSC-for-JavaScript" class="headerlink" title="With VSC for JavaScript"></a>With VSC for JavaScript</h2><p>Just by selecting the target JavaScript file, clicking on the Debug tab (Shift + Cmd + D on Mac) and hitting the ▶️ button should be enough to start debugging the current JavaScript file even without selecting any launch configuration. VS Code will automatically start Node with the –inspect parameter and attach to it.</p>
<p>You can also very easily create a launch configuration for attaching to a Node process running from the terminal.<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">            <span class="attr">"request"</span>: <span class="string">"attach"</span>,</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Attach"</span>,</span><br><span class="line">            <span class="attr">"port"</span>: <span class="number">9229</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>After the configuration is in place, start the application in inspection mode from the terminal.</p>
<h2 id="With-VSC-for-TypeScript"><a href="#With-VSC-for-TypeScript" class="headerlink" title="With VSC for TypeScript"></a>With VSC for TypeScript</h2><p>VS Code, when using a configuration “type”:”node” will not allow the program to be a .ts file (at least as this article is being written), then you’re left with 2 options: You can either run ts-node passing a .ts file as the argument (${relativeFile} returns the currently focused one):</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Current TS File"</span>,</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">            <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="attr">"program"</span>: <span class="string">"$&#123;workspaceRoot&#125;/node_modules/.bin/ts-node"</span>,</span><br><span class="line">            <span class="attr">"args"</span>: [<span class="string">"$&#123;relativeFile&#125;"</span>],</span><br><span class="line">            <span class="attr">"protocol"</span>: <span class="string">"inspector"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>or you can specify the runtimeExecutable to be NPM (instead of the default: node) and pass a script name as an argument. Both of them have the exact same effect:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">           <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">           <span class="attr">"name"</span>: <span class="string">"Launch via NPM"</span>,</span><br><span class="line">           <span class="attr">"runtimeExecutable"</span>: <span class="string">"npm"</span>,</span><br><span class="line">           <span class="attr">"runtimeArgs"</span>: [</span><br><span class="line">               <span class="string">"run-script"</span>,</span><br><span class="line">               <span class="string">"start:debug:ts"</span></span><br><span class="line">           ],</span><br><span class="line">           <span class="attr">"port"</span>: <span class="number">9229</span></span><br><span class="line">       &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>alternatively this one should work too:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"Launch current file w/ ts-node"</span>,</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"inspector"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [<span class="string">"$&#123;relativeFile&#125;"</span>],</span><br><span class="line">      <span class="attr">"cwd"</span>: <span class="string">"$&#123;workspaceRoot&#125;"</span>,</span><br><span class="line">      <span class="attr">"runtimeArgs"</span>: [<span class="string">"-r"</span>, <span class="string">"ts-node/register"</span>],</span><br><span class="line">      <span class="attr">"internalConsoleOptions"</span>: <span class="string">"openOnSessionStart"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>If you want, instead, to attach to a running TypeScript process spawn from a terminal, it is the exact same script we used for pure JavaScript.</p>
<h2 id="Debug-Vue-js-application-with-VSC-and-Chrome"><a href="#Debug-Vue-js-application-with-VSC-and-Chrome" class="headerlink" title="Debug Vue.js application with VSC and Chrome"></a>Debug Vue.js application with VSC and Chrome</h2><p><a href="https://vuejs.org/v2/cookbook/debugging-in-vscode.html" target="_blank" rel="noopener">Debugging Vue.js in VSC</a></p>
<h2 id="Debug-Jest-test-cases-with-VSC-and-Chrome"><a href="#Debug-Jest-test-cases-with-VSC-and-Chrome" class="headerlink" title="Debug Jest test cases with VSC and Chrome"></a>Debug Jest test cases with VSC and Chrome</h2><p><a href="https://jestjs.io/docs/en/troubleshooting" target="_blank" rel="noopener">Troubleshooting Jest</a></p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://hackernoon.com/debugging-javascript-typescript-node-apps-with-chrome-devtools-vs-code-and-webstorm-97b882aee0ad" target="_blank" rel="noopener">Debugging JavaScript/TypeScript Node apps with Chrome DevTools, VS Code and WebStorm</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node-js/">Node.js</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Debug/">Debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-nodejs-production-practices" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/19/nodejs-production-practices/" class="article-date">
  <time datetime="2018-06-19T00:10:18.000Z" itemprop="datePublished">2018-06-19</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/19/nodejs-production-practices/">Node.js Production Practices</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h1><h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a>Design</h2><h3 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h3><p>Structure your solution by self-contained components.</p>
<p>Each component should contain ‘layers’ - a dedicated object for the web, logic and data access code. This not only draws a clean separation of concerns but also significantly eases mocking and testing the system. Though this is a very common pattern, API developers tend to mix layers by passing the web layer objects (Express req, res) to business logic and data layers - this makes your application dependant on and accessible by Express only.</p>
<p>In a large app that constitutes a large code base, cross-cutting-concern utilities like logger, encryption and alike, should be wrapped by your own code and exposed as private NPM packages. This allows sharing them among multiple code bases and projects.</p>
<p>Avoid the nasty habit of defining the entire Express app in a single huge file - separate your ‘Express’ definition to at least two files: the API declaration (app.js) and the networking concerns (WWW). For even better structure, locate your API declaration within components.</p>
<h3 id="Handle-Different-Environments-and-Configurations"><a href="#Handle-Different-Environments-and-Configurations" class="headerlink" title="Handle Different Environments and Configurations"></a>Handle Different Environments and Configurations</h3><p>When dealing with configuration data, many things can just annoy and slow down:</p>
<ol>
<li><p>setting all the keys using process environment variables becomes very tedious when in need to inject 100 keys (instead of just committing those in a config file), however when dealing with files only the DevOps admins cannot alter the behavior without changing the code. A reliable config solution must combine both configuration files + overrides from the process variables</p>
</li>
<li><p>when specifying all keys in a flat JSON, it becomes frustrating to find and modify entries when the list grows bigger. A hierarchical JSON file that is grouped into sections can overcome this issue + few config libraries allow to store the configuration in multiple files and take care to union all at runtime. See example below</p>
</li>
<li><p>storing sensitive information like DB password is obviously not recommended but no quick and handy solution exists for this challenge. Some configuration libraries allow to encrypt files, others encrypt those entries during GIT commits or simply don’t store real values for those entries and specify the actual value during deployment via environment variables.</p>
</li>
<li><p>some advanced configuration scenarios demand to inject configuration values via command line (vargs) or sync configuration info via a centralized cache like Redis so multiple servers will use the same configuration data.</p>
</li>
</ol>
<p>Some configuration libraries can provide most of these features for free, have a look at NPM libraries like rc, nconf and config which tick many of these requirements.</p>
<h3 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h3><h3 id="Validation"><a href="#Validation" class="headerlink" title="Validation"></a>Validation</h3><h3 id="Use-Messaging-for-Background-Processes"><a href="#Use-Messaging-for-Background-Processes" class="headerlink" title="Use Messaging for Background Processes"></a>Use Messaging for Background Processes</h3><p>If you are using HTTP for sending messages, then whenever the receiving party is down, all your messages are lost. However, if you pick a persistent transport layer, like a message queue to send messages, you won’t have this problem.</p>
<p>If the receiving service is down, the messages will be kept, and can be processed later. If the service is not down, but there is an issue, processing can be retried, so no data gets lost.</p>
<h2 id="Unit-Testing"><a href="#Unit-Testing" class="headerlink" title="Unit Testing"></a>Unit Testing</h2><h2 id="E2E-Testing"><a href="#E2E-Testing" class="headerlink" title="E2E Testing"></a>E2E Testing</h2><h2 id="Linting-and-Styling"><a href="#Linting-and-Styling" class="headerlink" title="Linting and Styling"></a>Linting and Styling</h2><p>Prettier<br>ESLint/TSLint</p>
<p><a href="https://github.com/standard/standard" target="_blank" rel="noopener">https://github.com/standard/standard</a></p>
<p>integrated with git</p>
<h2 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h2><h1 id="Delivery-and-Deployment"><a href="#Delivery-and-Deployment" class="headerlink" title="Delivery and Deployment"></a>Delivery and Deployment</h1><h2 id="Dockerize"><a href="#Dockerize" class="headerlink" title="Dockerize"></a>Dockerize</h2><h2 id="Documentation"><a href="#Documentation" class="headerlink" title="Documentation"></a>Documentation</h2><p>JSDoc</p>
<h2 id="SemVer"><a href="#SemVer" class="headerlink" title="SemVer"></a>SemVer</h2><p>Versioning your application / modules is critical - your consumers must know if a new version of a module is published and what needs to be done on their side to get the new version.</p>
<p>This is where semantic versioning comes into the picture. Given a version number MAJOR.MINOR.PATCH, increment the:</p>
<ul>
<li>MAJOR version when you make incompatible API changes,</li>
<li>MINOR version when you add functionality (without breaking the API), and</li>
<li>PATCH version when you make backwards-compatible bug fixes.</li>
</ul>
<h2 id="PM2"><a href="#PM2" class="headerlink" title="PM2"></a>PM2</h2><h2 id="Logging-and-Tracing"><a href="#Logging-and-Tracing" class="headerlink" title="Logging and Tracing"></a>Logging and Tracing</h2><h2 id="Monitoring-and-Metrics"><a href="#Monitoring-and-Metrics" class="headerlink" title="Monitoring and Metrics"></a>Monitoring and Metrics</h2><p>Prometheus</p>
<h2 id="Scaling"><a href="#Scaling" class="headerlink" title="Scaling"></a>Scaling</h2><h2 id="Profiling"><a href="#Profiling" class="headerlink" title="Profiling"></a>Profiling</h2><ul>
<li><code>npm install -g autocannon</code></li>
<li><code>npm install -g clinic</code></li>
</ul>
<p><code>autocannon -c100 localhost:3000/seed/v1</code></p>
<p><code>clinic doctor --on-port=’autocannon -c100 localhost:$PORT/seed/v1’ -- node index.js</code></p>
<p><code>clinic flame --on-port=’autocannon -c100 localhost:$PORT/seed/v1’ -- node index.js</code></p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul>
<li><a href="https://www.smashingmagazine.com/2018/06/nodejs-tools-techniques-performance-servers/" target="_blank" rel="noopener">Keeping Node.js Fast: Tools, Techniques, And Tips For Making High-Performance Node.js Servers</a></li>
<li><a href="https://github.com/i0natan/nodebestpractices/blob/master/README.md#5-going-to-production-practices" target="_blank" rel="noopener">Node.js Best Practices</a></li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node-js/">Node.js</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Best-Practices/">Best Practices</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-typescript" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/18/typescript/" class="article-date">
  <time datetime="2018-06-18T05:34:21.000Z" itemprop="datePublished">2018-06-18</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/18/typescript/">TypeScript</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Installation-and-IDE-support"><a href="#Installation-and-IDE-support" class="headerlink" title="Installation and IDE support"></a>Installation and IDE support</h1><p><code>npm install -g typescript</code></p>
<p><code>tsc -v</code></p>
<p><code>tsc main.ts</code></p>
<p><code>tsc *.ts --watch</code></p>
<p><code>ts-node server.ts</code></p>
<p>VSC has built-in support of TypeScript.</p>
<p><a href="http://www.typescriptlang.org/play/index.html" target="_blank" rel="noopener">Online tool</a></p>
<p><a href="https://github.com/superliuwr/api_template_typescript" target="_blank" rel="noopener">Template Project</a></p>
<h1 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h1><h2 id="Static-Typing"><a href="#Static-Typing" class="headerlink" title="Static Typing"></a>Static Typing</h2><ul>
<li>number – All numeric values are represented by the number type, there aren’t separate definitions for integers, floats or others.</li>
<li>string – The text type, just like in vanilla JS strings can be surrounded by ‘single quotes’ or “double quotes”.</li>
<li>boolean – true or false, using 0 and 1 will cause a compilation error.</li>
<li>any – A variable with this type can have it’s value set to a string, number, or anything else.</li>
<li>Arrays – Has two possible syntaxes: my_arr: number[]; or my_arr: Array<number>.</number></li>
<li>void – Used on function that don’t return anything.</li>
<li>tuple - <code>let x: [ string, number ] = [ &quot;hello&quot;, 10 ]</code></li>
<li>enum - <code>enum Color { Red, Green, Blue }; let c: Color = Color.Green</code></li>
<li>null and undefined</li>
<li>never</li>
<li>union - <code>number | string</code></li>
</ul>
<h2 id="Interfaces"><a href="#Interfaces" class="headerlink" title="Interfaces"></a>Interfaces</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Food &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">    calories: <span class="built_in">number</span>;</span><br><span class="line">    readonly x: <span class="built_in">number</span>;</span><br><span class="line">    color?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> LoggerInterface&#123;</span><br><span class="line">    log(arg:<span class="built_in">any</span>):<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数接口</span></span><br><span class="line"><span class="keyword">interface</span> SearchFunc &#123;</span><br><span class="line">  (source: <span class="built_in">string</span>, subString: <span class="built_in">string</span>): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> StringArray&#123;</span><br><span class="line">    [index: <span class="built_in">number</span>]: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> MyArray: StringArray;</span><br><span class="line">MyArray = [<span class="string">"是"</span>,<span class="string">"云"</span>,<span class="string">"随"</span>,<span class="string">"风"</span>];</span><br><span class="line"><span class="built_in">console</span>.log(MyArray[<span class="number">2</span>]); <span class="comment">// 随</span></span><br></pre></td></tr></table></figure>
<h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a: <span class="built_in">number</span>, b?: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数参数</span></span><br><span class="line">function readFile(file: string, callback: (err: Error | null, data: Buffer) =&gt; void) &#123;</span><br><span class="line">  fs.readFile(file, callback);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 type 语句定义类型</span></span><br><span class="line"><span class="keyword">type</span> CallbackFunction = <span class="function">(<span class="params">err: <span class="built_in">Error</span> | <span class="literal">null</span>, data: Buffer</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">file: <span class="built_in">string</span>, callback: CallbackFunction</span>) </span>&#123;</span><br><span class="line">  fs.readFile(file, callback);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 interface 语句来定义类型</span></span><br><span class="line"><span class="keyword">interface</span> CallbackFunction &#123;</span><br><span class="line">  (err: <span class="built_in">Error</span> | <span class="literal">null</span>, data: Buffer): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">file: <span class="built_in">string</span>, callback: CallbackFunction</span>) </span>&#123;</span><br><span class="line">  fs.readFile(file, callback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Menu &#123;</span><br><span class="line">  <span class="comment">// Our properties:</span></span><br><span class="line">  <span class="comment">// By default they are public, but can also be private or protected.</span></span><br><span class="line">  <span class="keyword">private</span> items: <span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt;;  <span class="comment">// The items in the menu, an array of strings.</span></span><br><span class="line">  <span class="keyword">protected</span> pages: <span class="built_in">number</span>;         <span class="comment">// How many pages will the menu be, a number.</span></span><br><span class="line">  readonly other: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> numOfPages(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> pages.length;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A straightforward constructor. </span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">item_list: <span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt;, total_pages: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="comment">// The this keyword is mandatory.</span></span><br><span class="line">    <span class="keyword">this</span>.items = item_list;    </span><br><span class="line">    <span class="keyword">this</span>.pages = total_pages;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Methods</span></span><br><span class="line">  <span class="keyword">public</span> list(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Our menu for today:"</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.items.length; i++) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.items[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a new instance of the Menu class.</span></span><br><span class="line"><span class="keyword">var</span> sundayMenu = <span class="keyword">new</span> Menu([<span class="string">"pancakes"</span>,<span class="string">"waffles"</span>,<span class="string">"orange juice"</span>], <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Call the list method.</span></span><br><span class="line">sundayMenu.list();</span><br></pre></td></tr></table></figure>
<p>Inheritance</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> HappyMeal <span class="keyword">extends</span> Menu &#123;</span><br><span class="line">  <span class="comment">// Properties are inherited</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// A new constructor has to be defined.</span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">item_list: <span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt;, total_pages: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="comment">// In this case we want the exact same constructor as the parent class (Menu), </span></span><br><span class="line">    <span class="comment">// To automatically copy it we can call super() - a reference to the parent's constructor.</span></span><br><span class="line">    <span class="keyword">super</span>(item_list, total_pages);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Just like the properties, methods are inherited from the parent.</span></span><br><span class="line">  <span class="comment">// However, we want to override the list() function so we redefine it.</span></span><br><span class="line">  list(): <span class="built_in">void</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Our special menu for children:"</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.items.length; i++) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.items[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a new instance of the HappyMeal class.</span></span><br><span class="line"><span class="keyword">var</span> menu_for_children = <span class="keyword">new</span> HappyMeal([<span class="string">"candy"</span>,<span class="string">"drink"</span>,<span class="string">"toy"</span>], <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// This time the log message will begin with the special introduction.</span></span><br><span class="line">menu_for_children.list();</span><br></pre></td></tr></table></figure>
<h2 id="Generics"><a href="#Generics" class="headerlink" title="Generics"></a>Generics</h2><p>Generics are templates that allow the same function to accept arguments of various different types. Creating reusable components using generics is better than using the any data type, as generics preserve the types of the variables that go in and out of them.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The &lt;T&gt; after the function name symbolizes that it's a generic function.</span></span><br><span class="line"><span class="comment">// When we call the function, every instance of T will be replaced with the actual provided type.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Receives one argument of type T,</span></span><br><span class="line"><span class="comment">// Returns an array of type T.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">genericFunc</span>&lt;<span class="title">T</span>&gt;(<span class="params">argument: T</span>): <span class="title">T</span>[] </span>&#123;    </span><br><span class="line">  <span class="keyword">var</span> arrayOfT: T[] = [];    <span class="comment">// Create empty array of type T.</span></span><br><span class="line">  arrayOfT.push(argument);   <span class="comment">// Push, now arrayOfT = [argument].</span></span><br><span class="line">  <span class="keyword">return</span> arrayOfT;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arrayFromString = genericFunc&lt;<span class="built_in">string</span>&gt;(<span class="string">"beep"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arrayFromString[<span class="number">0</span>]);         <span class="comment">// "beep"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> arrayFromString[<span class="number">0</span>])   <span class="comment">// String</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arrayFromNumber = genericFunc(<span class="number">42</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arrayFromNumber[<span class="number">0</span>]);         <span class="comment">// 42</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> arrayFromNumber[<span class="number">0</span>])   <span class="comment">// number</span></span><br></pre></td></tr></table></figure>
<h2 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h2><p>External modules as comparing to <code>Namespaces</code>.</p>
<h2 id="Third-party-Declaration-Files"><a href="#Third-party-Declaration-Files" class="headerlink" title="Third-party Declaration Files"></a>Third-party Declaration Files</h2><p>When using a library that was originally designed for regular JavaScript, we need to apply a declaration file to make that library compatible with TypeScript. A declaration file has the extension .d.ts and contains various information about the library and its API.</p>
<p>TypeScript declaration files are usually written by hand, but there’s a high chance that the library you need already has a .d.ts. file created by somebody else. DefinitelyTyped is the biggest public repository, containing files for over a thousand libraries. There is also a popular Node.js module for managing TypeScript definitions called Typings.</p>
<p>当遇到缺少模块声明文件的情况，开发者可以尝试通过 npm install @types/xxx 来安装模块声明文件即可。</p>
<p>如果我们使用的第三方模块在 DefinitelyTyped 找不到对应声明文件，也可以尝试使用require()这个终极的解决方法，它会将模块解析成 any 类型，不好的地方就是没有静态类型检查了。</p>
<h2 id="Advanced-Types-and-Type-Guards"><a href="#Advanced-Types-and-Type-Guards" class="headerlink" title="Advanced Types and Type Guards"></a>Advanced Types and Type Guards</h2><h2 id="Namespaces"><a href="#Namespaces" class="headerlink" title="Namespaces"></a>Namespaces</h2><p>模块是用来组织一些具有某种内在联系的特性和对象。模块能够使代码的结构更加清晰，可以使用 namespace 和 export 关键字在 TypeScript 中声明模块。</p>
<p>Internal modules as comparing to <code>Modules</code>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> mygame&#123;</span><br><span class="line">    <span class="keyword">interface</span> Test1Interface&#123;</span><br><span class="line">        <span class="comment">/*...*/</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">interface</span> Test2Interface&#123;</span><br><span class="line">        <span class="comment">/*...*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">interface</span> Test3Interface&#123;</span><br><span class="line">        <span class="comment">/*...*/</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">class</span> Rect&#123;</span><br><span class="line">        <span class="comment">/*...*/</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">class</span> Circle <span class="keyword">implements</span> Test2Interface&#123;</span><br><span class="line">        <span class="comment">/*...*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="tsconfig-json-配置文件"><a href="#tsconfig-json-配置文件" class="headerlink" title="tsconfig.json 配置文件"></a>tsconfig.json 配置文件</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//tsconfig.json 指定了用来编译这个项目的根文件和编译选项。</span><br><span class="line">&#123;</span><br><span class="line">  "compilerOptions": &#123;     //compilerOptions:编译选项,可以被忽略，这时编译器会使用默认值</span><br><span class="line">    "allowSyntheticDefaultImports": true,//允许从没有设置默认导出的模块中默认导入。这并不影响代码的显示，仅为了类型检查。</span><br><span class="line">    "baseUrl": "./src",//解析非相对模块名的基准目录</span><br><span class="line">    "emitDecoratorMetadata": true, //给源码里的装饰器声明加上设计类型元数据</span><br><span class="line">    "experimentalDecorators": true,//启用实验性的ES装饰器</span><br><span class="line">    "module": "commonjs",        //指定生成哪个模块系统代码</span><br><span class="line">    "moduleResolution": "node",  //决定如何处理模块。或者是"Node"对于Node.js/io.js，或者是"Classic"（默认）</span><br><span class="line">    "noEmitHelpers": true,//不再输出文件中生成用户自定义的帮助函数代码，如__extends。</span><br><span class="line">    "noImplicitAny": false,     //在表达式和声明上有隐含的any类型时报错</span><br><span class="line">    "sourceMap": true,          //用于debug ,生成相应的.map文件</span><br><span class="line">    "strictNullChecks": false,//在严格的null检查模式下，null和undefined值不包含在任何类型里，只允许用它们自己和any来赋值（有个例外，undefined可以赋值到void）。</span><br><span class="line">    "target": "es5",             //目标代码类型</span><br><span class="line">    "paths": &#123;  //模块名到基于baseUrl的路径映射的列表</span><br><span class="line">    &#125;,</span><br><span class="line">    "lib": [  //编译过程中需要引入的库文件的列表</span><br><span class="line">        "dom",</span><br><span class="line">        <span class="string">"es6"</span></span><br><span class="line">      ],</span><br><span class="line">    "types": [  //要包含的类型声明文件名列表；如果指定了types，只有被列出来的包才会被包含进来</span><br><span class="line">      "hammerjs",</span><br><span class="line">      "node",</span><br><span class="line">      "source-map",</span><br><span class="line">      "uglify-js",</span><br><span class="line">      <span class="string">"webpack"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  "exclude": [  //如果"files"和"include"都没有被指定，编译器默认包含当前目录和子目录下所有的TypeScript文件（.ts, .d.ts 和 .tsx），排除在"exclude"里指定的文件。</span><br><span class="line">    "node_modules",</span><br><span class="line">    <span class="string">"dist"</span></span><br><span class="line">  ],</span><br><span class="line">  "awesomeTypescriptLoaderOptions": &#123;  //Typescript加载选项</span><br><span class="line">    "forkChecker": true,</span><br><span class="line">    "useWebpackText": true</span><br><span class="line">  &#125;,</span><br><span class="line">  "compileOnSave": false,          </span><br><span class="line">  "buildOnSave": false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="TSLint-代码规范检查"><a href="#TSLint-代码规范检查" class="headerlink" title="TSLint 代码规范检查"></a>TSLint 代码规范检查</h2><h2 id="发布模块"><a href="#发布模块" class="headerlink" title="发布模块"></a>发布模块</h2><p>相比直接使用 JavaScript 编写的 npm 模块，使用 TypeScript 编写的模块需要增加以下几个额外的工作：</p>
<ul>
<li>发布前将 TypeScript 源码编译成 JavaScript.</li>
<li>需要修改 tsconfig.json 的配置，使得编译时生成模块对应的 .d.ts 文件。</li>
<li>在 package.json 文件增加 types 属性。</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"module"</span>: <span class="string">"commonjs"</span>,</span><br><span class="line">    <span class="attr">"moduleResolution"</span>: <span class="string">"node"</span>,</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"es6"</span>,</span><br><span class="line">    <span class="attr">"rootDir"</span>: <span class="string">"src"</span>,</span><br><span class="line">    <span class="attr">"outDir"</span>: <span class="string">"dist"</span>,</span><br><span class="line">    <span class="attr">"sourceMap"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"declaration"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitAny"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitReturns"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitThis"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"dist/math.js"</span>,</span><br><span class="line">  <span class="attr">"typings"</span>: <span class="string">"dist/math.d.ts"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"compile"</span>: <span class="string">"rm -rf dist &amp;&amp; tsc"</span>,</span><br><span class="line">    <span class="attr">"prepublish"</span>: <span class="string">"npm run compile"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>要执行使用 TypeScript 编写的单元测试程序，可以有两种方法：</p>
<ul>
<li>先通过 tsc 编译成 JavaScript 代码后，再执行。</li>
<li>直接执行 .ts 源文件。</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"mocha --compilers ts:ts-node/register src/test.ts"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://zhongsp.gitbooks.io/typescript-handbook/content/index.html" target="_blank" rel="noopener">https://zhongsp.gitbooks.io/typescript-handbook/content/index.html</a></li>
<li><a href="http://www.typescriptlang.org/docs/tutorial.html" target="_blank" rel="noopener">http://www.typescriptlang.org/docs/tutorial.html</a></li>
<li><a href="https://legacy.gitbook.com/book/basarat/typescript/details" target="_blank" rel="noopener">https://legacy.gitbook.com/book/basarat/typescript/details</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node-js/">Node.js</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TypeScript/">TypeScript</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-aws-security" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/16/aws-security/" class="article-date">
  <time datetime="2018-06-16T02:54:01.000Z" itemprop="datePublished">2018-06-16</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/16/aws-security/">AWS Security</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="AWS-Identity-and-Access-Management-IAM"><a href="#AWS-Identity-and-Access-Management-IAM" class="headerlink" title="AWS Identity and Access Management (IAM)"></a>AWS Identity and Access Management (IAM)</h1><p>IAM is a powerful service that allows you to control how people and programs are allowed to manipulate your AWS infrastructure.</p>
<p>IAM is not:</p>
<ul>
<li>an identity store/authorization system for your applications<ul>
<li>use AWS Directory Service or Cognito instead</li>
</ul>
</li>
<li>operating system identity management<ul>
<li>shared responsibility</li>
</ul>
</li>
</ul>
<h2 id="Principals"><a href="#Principals" class="headerlink" title="Principals"></a>Principals</h2><h3 id="Root-user"><a href="#Root-user" class="headerlink" title="Root user"></a>Root user</h3><p>it has full privileges to do anything in the account, including closing the account. It is strongly recommended that you do not use the root user for your everyday tasks, even the administrative ones.</p>
<h3 id="IAM-users"><a href="#IAM-users" class="headerlink" title="IAM users"></a>IAM users</h3><p>no expiration period</p>
<h3 id="ROLES-TEMPORARY-SECURITY-TOKENS"><a href="#ROLES-TEMPORARY-SECURITY-TOKENS" class="headerlink" title="ROLES/TEMPORARY SECURITY TOKENS"></a>ROLES/TEMPORARY SECURITY TOKENS</h3><p>Roles are used to grant specific privileges to specific <strong>actors</strong> for a set duration of time. These actors can be authenticated by AWS or some trusted external system. When one of these actors assumes a role, AWS provides the actor with a <strong>temporary security token</strong> from the AWS Security Token Service (STS) that the actor can use to access AWS Cloud services. Requesting a temporary security token requires specifying how long the token will exist before it expires. The range of a temporary security token lifetime is 15 minutes to 36 hours.</p>
<p>Roles and temporary security tokens enable a number of use cases:</p>
<ul>
<li>Amazon EC2 Roles<ul>
<li>Granting permissions to applications running on an Amazon EC2 instance.</li>
</ul>
</li>
<li>Cross-Account Access<ul>
<li>Granting permissions to users from other AWS accounts, whether you control those accounts or not.</li>
</ul>
</li>
<li>Federation<ul>
<li>Granting permissions to users authenticated by a trusted external system.</li>
</ul>
</li>
</ul>
<h4 id="Amazon-EC2-Roles"><a href="#Amazon-EC2-Roles" class="headerlink" title="Amazon EC2 Roles"></a>Amazon EC2 Roles</h4><p>Suppose that an application running on an Amazon EC2 instance needs to access an Amazon Simple Storage Service (Amazon S3) bucket. An IAM role that grants the required access to the Amazon S3 bucket. When the Amazon EC2 instance is launched, the role is assigned to the instance. When the application running on the instance uses the Application Programming Interface (API) to access the Amazon S3 bucket, it assumes the role assigned to the instance and obtains a temporary token that it sends to the API. The process of obtaining the temporary token and passing it to the API is handled automatically by most of the AWS SDKs, allowing the application to make a call to access the Amazon S3 bucket without worrying about authentication.</p>
<h4 id="Crosss-account-Access"><a href="#Crosss-account-Access" class="headerlink" title="Crosss-account Access"></a>Crosss-account Access</h4><p>You can set up an IAM role with the permissions you want to grant to users in the other account, then users in the other account can assume that role to access your resources.</p>
<h4 id="Federation"><a href="#Federation" class="headerlink" title="Federation"></a>Federation</h4><p>IAM Identity Providers provide the ability to federate these outside identities with IAM and assign privileges to those users authenticated outside of IAM.</p>
<ul>
<li>OpenID Connect</li>
<li>SAML</li>
</ul>
<h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><ul>
<li>User name/Password</li>
<li>Access Key ID/Access Secret Key</li>
<li>Access Key ID/Access Secret Key/Session Token<ul>
<li>When a process operates under an assumed role, the temporary security token provides an access key for authentication. In addition to the access key (remember that it consists of two parts), the token also includes a session token. Calls to AWS must include both the two-part access key and the session token to authenticate.</li>
</ul>
</li>
</ul>
<h2 id="Authorization"><a href="#Authorization" class="headerlink" title="Authorization"></a>Authorization</h2><p>Authorization is handled in IAM by defining specific privileges in policies and associating those policies with principals.</p>
<h3 id="POLICIES"><a href="#POLICIES" class="headerlink" title="POLICIES"></a>POLICIES</h3><p>A policy is a JSON document that fully defines a set of permissions to access and manipulate AWS resources. Policy documents contain one or more permissions, with each permission defining:</p>
<ul>
<li>Effect—A single word: Allow or Deny.</li>
<li>Service—For what service does this permission apply? Most AWS Cloud services support granting access through IAM, including IAM itself.</li>
<li>Resource—The resource value specifies the specific AWS infrastructure for which this permission applies. This is specified as an Amazon Resource Name (ARN). The format for an ARN varies slightly between services, but the basic format is: “arn:aws:service:region:account-id:[resourcetype:]resource”</li>
<li>Action—The action value specifies the subset of actions within a service that the permission allows or denies. </li>
<li>Condition—The condition value optionally defines one or more additional restrictions that limit the actions allowed by the permission.</li>
</ul>
<p>A Sample policy:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"Version"</span>: <span class="string">"2012–10–17"</span>,</span><br><span class="line">    <span class="attr">"Statement"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"Sid"</span>: <span class="string">"Stmt1441716043000"</span>,</span><br><span class="line">            "Effect": "Allow",	&lt;-  This policy grants access</span><br><span class="line">            "Action": [	&lt;-  Allows identities to list</span><br><span class="line">                "s3:GetObject",	&lt;-  and get objects in</span><br><span class="line">                "s3:ListBucket"	&lt;-  the S3 bucket</span><br><span class="line">            ],</span><br><span class="line">            "Condition": &#123;</span><br><span class="line">                "IpAddress": &#123;				&lt;-  Only from a specific</span><br><span class="line">                    "aws:SourceIp": "192.168.0.1"	&lt;-  IP Address</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            "Resource": [</span><br><span class="line">                "arn:aws:s3:::my_public_bucket/*"	&lt;-  Only this bucket</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="ASSOCIATING-POLICIES-WITH-PRINCIPALS"><a href="#ASSOCIATING-POLICIES-WITH-PRINCIPALS" class="headerlink" title="ASSOCIATING POLICIES WITH PRINCIPALS"></a>ASSOCIATING POLICIES WITH PRINCIPALS</h3><p>A policy can be associated directly with an IAM user in one of two ways:</p>
<ul>
<li>User Policy—These policies exist only in the context of the user to which they are attached. In the console, a user policy is entered into the user interface on the IAM user page.</li>
<li>Managed Policies—These policies are created in the Policies tab on the IAM page (or through the CLI, and so forth) and exist independently of any individual user. In this way, the same policy can be associated with many users or groups of users. There are a large number of predefined managed policies that you can review on the Policies tab of the IAM page in the AWS Management Console. In addition, you can write your own policies specific to your use cases.</li>
</ul>
<p>The other common method for associating policies with users is with the IAM groups feature. Groups simplify managing permissions for large numbers of users. After a policy is assigned to a group, any user who is a member of that group assumes those permissions.</p>
<p>There are two ways a policy can be associated with an IAM group:</p>
<ul>
<li>Group Policy—These policies exist only in the context of the group to which they are attached. In the AWS Management Console, a group policy is entered into the user interface on the IAM Group page.</li>
<li>Managed Policies—In the same way that managed policies (discussed in the “Authorization” section) can be associated with IAM users, they can also be associated with IAM groups.</li>
</ul>
<p>The final way an actor can be associated with a policy is by assuming a role. In this case, the actor can be:</p>
<ul>
<li>An authenticated IAM user (person or process). In this case, the IAM user must have the rights to assume the role.</li>
<li>A person or process authenticated by a trusted service outside of AWS, such as an on-premises LDAP directory or a web authentication service. In this situation, an AWS Cloud service will assume the role on the actor’s behalf and return a token to the actor.</li>
</ul>
<p>After an actor has assumed a role, it is provided with a temporary security token associated with the policies of that role. The token contains all the information required to authenticate API calls. This information includes a standard access key plus an additional session token required for authenticating calls under an assumed role.</p>
<h2 id="Other-Key-Features"><a href="#Other-Key-Features" class="headerlink" title="Other Key Features"></a>Other Key Features</h2><h3 id="MULTI-FACTOR-AUTHENTICATION-MFA"><a href="#MULTI-FACTOR-AUTHENTICATION-MFA" class="headerlink" title="MULTI-FACTOR AUTHENTICATION (MFA)"></a>MULTI-FACTOR AUTHENTICATION (MFA)</h3><h2 id="ROTATING-KEYS"><a href="#ROTATING-KEYS" class="headerlink" title="ROTATING KEYS"></a>ROTATING KEYS</h2><h2 id="RESOLVING-MULTIPLE-PERMISSIONS"><a href="#RESOLVING-MULTIPLE-PERMISSIONS" class="headerlink" title="RESOLVING MULTIPLE PERMISSIONS"></a>RESOLVING MULTIPLE PERMISSIONS</h2><ol>
<li>Initially the request is denied by default.</li>
<li>All the appropriate policies are evaluated; if there is an explicit “deny” found in any policy, the request is denied and evaluation stops.</li>
<li>If no explicit “deny” is found and an explicit “allow” is found in any policy, the request is allowed.</li>
<li>If there are no explicit “allow” or “deny” permissions found, then the default “deny” is maintained and the request is denied.</li>
</ol>
<p>The only exception to this rule is if an AssumeRole call includes a role and a policy, the policy cannot expand the privileges of the role (for example, the policy cannot override any permission that is denied by default in the role).</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Cloud/">Cloud</a>»<a class="article-category-link" href="/categories/Cloud/DevOps/">DevOps</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AWS/">AWS</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-aws" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/16/aws/" class="article-date">
  <time datetime="2018-06-16T02:50:58.000Z" itemprop="datePublished">2018-06-16</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/16/aws/">AWS</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><h2 id="Cloud-computing-deployment-modes"><a href="#Cloud-computing-deployment-modes" class="headerlink" title="Cloud computing deployment modes"></a>Cloud computing deployment modes</h2><ul>
<li>all-in cloud-based application deployment</li>
<li>hybrid deployment</li>
</ul>
<h2 id="Regions-Availability-Zones-and-Edge-locations"><a href="#Regions-Availability-Zones-and-Edge-locations" class="headerlink" title="Regions, Availability Zones and Edge locations"></a>Regions, Availability Zones and Edge locations</h2><ul>
<li>AWS Management Console</li>
<li>CLI</li>
<li>SDKs</li>
</ul>
<p>AWS provides a highly available technology infrastructure platform with multiple locations worldwide. These locations are composed of regions and Availability Zones. Each <strong>region</strong> is a separate geographic area. Each region has multiple, isolated locations known as Availability Zones. AWS enables the placement of resources and data in multiple locations. Resources aren’t replicated across regions unless organizations choose to do so.</p>
<p>Each region is completely independent and is designed to be completely isolated from the other regions. This achieves the greatest possible fault tolerance and stability. Each <strong>Availability Zone</strong> is also isolated, but the Availability Zones in a region are connected through low-latency links.</p>
<p>An <strong>Edge location</strong> is a CDN or Content Delivery Network endpoint for CloudFront.</p>
<h2 id="ACCESSING-THE-PLATFORM"><a href="#ACCESSING-THE-PLATFORM" class="headerlink" title="ACCESSING THE PLATFORM"></a>ACCESSING THE PLATFORM</h2><h1 id="Topics"><a href="#Topics" class="headerlink" title="Topics"></a>Topics</h1><p><a href="aws-security.md">Security</a></p>
<p><a href="aws-networking.md">Networking</a></p>
<p><a href="aws-computing.md">Computing</a></p>
<p><a href="aws-storage.md">Storage</a></p>
<p><a href="aws-database.md">Database</a></p>
<p><a href="aws-analytics.md">Analytics</a></p>
<p><a href="aws-developer-management-tool.md">Developer and Management Tool</a></p>
<p><a href="aws-mobile-application-services.md">Mobile and Application Services</a></p>
<p><a href="aws-high-availability-fault-tolerance.md">High Availability and Fault Tolerance</a></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Cloud/">Cloud</a>»<a class="article-category-link" href="/categories/Cloud/DevOps/">DevOps</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AWS/">AWS</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-hyperledger-overview" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/14/hyperledger-overview/" class="article-date">
  <time datetime="2018-06-14T11:34:54.000Z" itemprop="datePublished">2018-06-14</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/14/hyperledger-overview/">hyperledger-overview</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Hyperledger Fabric 是 IBM 贡献给 Linux 基金会的商用分布式账本系统，自项目创立伊始就吸引了金融、银行、互联网、传统行业领域的巨头们的眼光。</p>
<p>Hyperledger Fabric 是基于 Golang 实现的可插拔的区块链系统，它主要面向企业之间或者企业多个部门之间提供服务。</p>
<p><img src="architecture.jpg" alt="Architecture"></p>
<ul>
<li>Membership 即成员管理服务，提供身份管理、证书校验。在 Fabric 中每个通讯组件都必须提供身份证明，每个事务的发起者会被永久记录在区块链上，审核人员可以追溯事务。</li>
<li>Blockchain Services 即区块链服务，提供分布式一致性算法，维护全网数据一致，提供账本存储服务，基于 P2P 网络实现节点之间的通讯。</li>
<li>Chaincode Services 即链码服务，智能合约在 Fabric 中称为链码。链码是操作状态数据库的唯一方法，大部分事务都是通过链码完成的。该部分提供链码的部署和运行环境。</li>
</ul>
<h1 id="区块链"><a href="#区块链" class="headerlink" title="区块链"></a>区块链</h1><p>区块链是一种<strong>分布式多写</strong>的、<strong>防篡改</strong>的<strong>数据库</strong></p>
<h2 id="分布式多写"><a href="#分布式多写" class="headerlink" title="分布式多写"></a>分布式多写</h2><h3 id="共识算法"><a href="#共识算法" class="headerlink" title="共识算法"></a>共识算法</h3><p>多写一定要保证数据最终一致性；也搞清楚解决问题的办法——通过“固定的”规则决定顺序，节点中的所有服务器只要遵循这个规则那么数据最终一定一致。</p>
<h3 id="拜占庭将军和-PBFT"><a href="#拜占庭将军和-PBFT" class="headerlink" title="拜占庭将军和 PBFT"></a>拜占庭将军和 PBFT</h3><p>拜占庭将军问题是要解决在一个消息可能丢失、重复、伪造的环境达到数据一致问题。</p>
<p>接下来看 Practical Byzantine Fault Tolerance（PBFT）算法，它的过程如下：</p>
<ol>
<li>从全网节点选举出一个主节点，新区块由主节点负责生成。</li>
<li>每个节点把新交易向全网广播，主节点把从网络收集到需放在新区块内的多个交易排序后存入列表，并将该列表向全网广播。</li>
<li>每个节点接收到交易列表后，依据排序模拟执行交易。所有交易执行完后，基于交易结果计算新区块的哈希摘要，并向全网广播。</li>
<li>如果一个节点收到的 2f（f 为可容忍的恶意节点数）条其它节点发来的摘要都和自己相同，就向全网广播一条 commit 消息。</li>
<li>如果一个节点收到 2f+1 条 commit 消息， 即可正式提交新区块及其交易到本地的区块链和状态数据库。</li>
</ol>
<p>PBFT只适合于内部使用（联盟链或者私有链），因为互联网上不太可能确定“全网排序节点”。</p>
<h3 id="防篡改"><a href="#防篡改" class="headerlink" title="防篡改"></a>防篡改</h3><p><img src="merkle tree.jpg" alt="Merkle Tree"></p>
<p>所有的数据（事务）都放在二叉树的叶子节点，非叶子节点是其对应子节点的 Hash 值。当数据发生变化会引起非叶子节点的连环变化，最终引起 Root 的变化。</p>
<p>区块链的底层存储是一个链表，包括区块头和区块体。头部是一个链表结构，分别是前一块的 Hash 值、Merkle Root、本数据块的 Hash 值（Nonce)；区块体是一个树结构，叶子节点是事务（Tx），其他节点是下级节点的 Hash 值，最终树根的 Hash 值就叫 Merkle Root，放在头部。</p>
<p><img src="block.jpg" alt="Blocks"></p>
<p>所以如果要篡改某个区块必须把该区块的所有前驱都给修改掉，修改比较麻烦——注意不是不能修改</p>
<p>对于比特币来说仅仅做到这一点是不够的，它毕竟是数字货币，利益诱惑比较大。所以比特币设计了两个门槛：</p>
<ul>
<li>最新的前驱节点（最新的数据块）不一定被篡改者算出来，除非计算能力特别强大；</li>
<li>区块的 Hash 值是特殊的，PoW 中的“Hash 游戏”是寻找一种特别的 Hash 值，只能通过不断遍历才可能算出这个值，这也是“工作量”体现。所以重新计算 Hash 值相当于重新进行工作量计算，这个计算开销也非常巨大。相当于把整个链上的区块全部重新算一遍。</li>
</ul>
<h1 id="Hyperledger-和-Fabric"><a href="#Hyperledger-和-Fabric" class="headerlink" title="Hyperledger 和 Fabric"></a>Hyperledger 和 Fabric</h1><p>Hyperledger 是一个开放源代码的区块链和相关工具的总括项目，由 Linux 基金会管理。Fabric 是一个商用分布式账本，它最早由 IBM 和 Digital Asset 贡献给了 Hyperledger 项目。它主要用于“企业内部使用”，技术架构选择了和比特币、以太坊完全不同的策略。</p>
<h2 id="Fabric-的共识设计"><a href="#Fabric-的共识设计" class="headerlink" title="Fabric 的共识设计"></a>Fabric 的共识设计</h2><p>Fabric 被设计为一个数据存储系统，写入速度是一个非常重要的性能指标，所以不可能采用 PoW 算法。</p>
<p>共识就是要解决排序问题</p>
<p>Fabric 采用了一个很简单、粗暴，而又充满工程化考虑的设计方案——排序节点（PBFT 算法）。在整个网络中有一个或者一组节点充当排序节点，其他节点都按照排序节点给出的顺序进行数据写入，完整的过程如下图所示。</p>
<p><img src="pbft.jpg" alt="PBFT"></p>
<p>应用程序首先向所有 Peer 节点（也有文档叫背书节点、记账节点）发起“记账要求”（Proposal）；每个节点把数据记录下来——此时还没有提交到状态数据库（没有生效），然后返回应用程序一个“事务签名”（Proposal Response）；应用程序把“事务签名”发送给排序服务器，排序服务器可能同时收到很多事务，按照一定规则给出事务的顺序，发送给记账节点；记账节点在收到排序服务器的顺序后会校验一下“事务签名”确定是自己给出的票然后更新状态数据库，数据生效。这个过程可以简单的归纳为投票 -&gt; 排序 -&gt; 验证。</p>
<p>排序服务器排序的规则有两种，SOLO 和 Kafka 。可以把 SOLO 机制理解为单机版的队列，排序服务器按收到的顺序依次放入队列。SOLO 的性能并不高，在开发环境中用这种机制，生产环境建议使用“真刀真枪的 MQ”——Kafka。</p>
<h2 id="Fabric-的防篡改机制"><a href="#Fabric-的防篡改机制" class="headerlink" title="Fabric 的防篡改机制"></a>Fabric 的防篡改机制</h2><p>比特币防篡改的机制是基于 PoW 精心设计的，如果要修改数据那么必须“算力足够”，所以比特币的一切都是围绕 PoW 设计，而设计目标则是——发币。对于没有采用 PoW 的 Fabric 来说防篡改机制必须另谋出路。</p>
<p>这个“出路”其实不是技术考虑，更多的是业务场景考虑。Fabric 主要面向内部使用（联盟链或者私有链）“内部环境”比较容易实现“审计机制”，我们可以通过 Fabric 的 Event 记录整个系统的运行过程，当数据不一致的时候通过“审计机制”发现谁的数据有问题（需要人工介入）然后把它“踢”出去。简单来说——Fabric 的防篡改是“人肉审计”机制。</p>
<p>Fabric 提供一个模块化的构架，其中的节点、智能合约、共识机制、成员服务都是模块化，可扩展的。如果开发者觉得 Fabric 的设计策略不适合，那么可以做相关的扩展开发。</p>
<h3 id="Fabric-基本概念"><a href="#Fabric-基本概念" class="headerlink" title="Fabric 基本概念"></a>Fabric 基本概念</h3><ul>
<li>Channel，一个“链”。可以理解为一个数据库。以太坊、比特币它们都属于“单链”，Fabric 可以同时运行多个链。</li>
<li>Chaincode，链码。区块链上的数据改变都是通过智能合约操作的，在 Fabric 中智能合约叫 ChainCode。</li>
<li>Fabric 网络，在 Fabric 中组成区块链系统的各个进程组成的通讯网络叫 Fabric 网络。<br>Fabric 网络可以是由一个物理节点组成，也可以由多个不同的物理节点组成。一般在开发环境中运行在同一个物理节点上（开发者自己的机器），在生产环境中需要根据组织或者部门在不同的节点上启动相关进程。</li>
</ul>
<p>Fabric 提供了各个平台的二进制文件，但是一般不直接使用这些二进制文件，而是通过容器的方式部署系统。</p>
<p>锚节点 Peer （Anchor peer）</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Blockchain/">Blockchain</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Blockchain/">Blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hyperledger/">Hyperledger</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:superliuwr.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">SUPERLOG</a>
	</h1>
	<span class="copyright">
		&copy; 2018 Marvin Liu<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>