<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SUPERLOG</title>
  <meta name="viewport" content="width=device-width">
  <meta property="og:type" content="website">
<meta property="og:title" content="SUPERLOG">
<meta property="og:url" content="http://superliuwr.github.io/index.html">
<meta property="og:site_name" content="SUPERLOG">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SUPERLOG">
  
    <link rel="alternative" href="/atom.xml" title="SUPERLOG" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">SUPERLOG</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://superliuwr.github.io"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-aws-security" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/16/aws-security/" class="article-date">
  <time datetime="2018-06-16T02:54:01.000Z" itemprop="datePublished">2018-06-16</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/16/aws-security/">AWS Security</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="AWS-Identity-and-Access-Management-IAM"><a href="#AWS-Identity-and-Access-Management-IAM" class="headerlink" title="AWS Identity and Access Management (IAM)"></a>AWS Identity and Access Management (IAM)</h1><p>IAM is a powerful service that allows you to control how people and programs are allowed to manipulate your AWS infrastructure.</p>
<p>IAM is not:</p>
<ul>
<li>an identity store/authorization system for your applications<ul>
<li>use AWS Directory Service or Cognito instead</li>
</ul>
</li>
<li>operating system identity management<ul>
<li>shared responsibility</li>
</ul>
</li>
</ul>
<h2 id="Principals"><a href="#Principals" class="headerlink" title="Principals"></a>Principals</h2><h3 id="Root-user"><a href="#Root-user" class="headerlink" title="Root user"></a>Root user</h3><p>it has full privileges to do anything in the account, including closing the account. It is strongly recommended that you do not use the root user for your everyday tasks, even the administrative ones.</p>
<h3 id="IAM-users"><a href="#IAM-users" class="headerlink" title="IAM users"></a>IAM users</h3><p>no expiration period</p>
<h3 id="ROLES-TEMPORARY-SECURITY-TOKENS"><a href="#ROLES-TEMPORARY-SECURITY-TOKENS" class="headerlink" title="ROLES/TEMPORARY SECURITY TOKENS"></a>ROLES/TEMPORARY SECURITY TOKENS</h3><p>Roles are used to grant specific privileges to specific <strong>actors</strong> for a set duration of time. These actors can be authenticated by AWS or some trusted external system. When one of these actors assumes a role, AWS provides the actor with a <strong>temporary security token</strong> from the AWS Security Token Service (STS) that the actor can use to access AWS Cloud services. Requesting a temporary security token requires specifying how long the token will exist before it expires. The range of a temporary security token lifetime is 15 minutes to 36 hours.</p>
<p>Roles and temporary security tokens enable a number of use cases:</p>
<ul>
<li>Amazon EC2 Roles<ul>
<li>Granting permissions to applications running on an Amazon EC2 instance.</li>
</ul>
</li>
<li>Cross-Account Access<ul>
<li>Granting permissions to users from other AWS accounts, whether you control those accounts or not.</li>
</ul>
</li>
<li>Federation<ul>
<li>Granting permissions to users authenticated by a trusted external system.</li>
</ul>
</li>
</ul>
<h4 id="Amazon-EC2-Roles"><a href="#Amazon-EC2-Roles" class="headerlink" title="Amazon EC2 Roles"></a>Amazon EC2 Roles</h4><p>Suppose that an application running on an Amazon EC2 instance needs to access an Amazon Simple Storage Service (Amazon S3) bucket. An IAM role that grants the required access to the Amazon S3 bucket. When the Amazon EC2 instance is launched, the role is assigned to the instance. When the application running on the instance uses the Application Programming Interface (API) to access the Amazon S3 bucket, it assumes the role assigned to the instance and obtains a temporary token that it sends to the API. The process of obtaining the temporary token and passing it to the API is handled automatically by most of the AWS SDKs, allowing the application to make a call to access the Amazon S3 bucket without worrying about authentication.</p>
<h4 id="Crosss-account-Access"><a href="#Crosss-account-Access" class="headerlink" title="Crosss-account Access"></a>Crosss-account Access</h4><p>You can set up an IAM role with the permissions you want to grant to users in the other account, then users in the other account can assume that role to access your resources.</p>
<h4 id="Federation"><a href="#Federation" class="headerlink" title="Federation"></a>Federation</h4><p>IAM Identity Providers provide the ability to federate these outside identities with IAM and assign privileges to those users authenticated outside of IAM.</p>
<ul>
<li>OpenID Connect</li>
<li>SAML</li>
</ul>
<h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><ul>
<li>User name/Password</li>
<li>Access Key ID/Access Secret Key</li>
<li>Access Key ID/Access Secret Key/Session Token<ul>
<li>When a process operates under an assumed role, the temporary security token provides an access key for authentication. In addition to the access key (remember that it consists of two parts), the token also includes a session token. Calls to AWS must include both the two-part access key and the session token to authenticate.</li>
</ul>
</li>
</ul>
<h2 id="Authorization"><a href="#Authorization" class="headerlink" title="Authorization"></a>Authorization</h2><p>Authorization is handled in IAM by defining specific privileges in policies and associating those policies with principals.</p>
<h3 id="POLICIES"><a href="#POLICIES" class="headerlink" title="POLICIES"></a>POLICIES</h3><p>A policy is a JSON document that fully defines a set of permissions to access and manipulate AWS resources. Policy documents contain one or more permissions, with each permission defining:</p>
<ul>
<li>Effect—A single word: Allow or Deny.</li>
<li>Service—For what service does this permission apply? Most AWS Cloud services support granting access through IAM, including IAM itself.</li>
<li>Resource—The resource value specifies the specific AWS infrastructure for which this permission applies. This is specified as an Amazon Resource Name (ARN). The format for an ARN varies slightly between services, but the basic format is: “arn:aws:service:region:account-id:[resourcetype:]resource”</li>
<li>Action—The action value specifies the subset of actions within a service that the permission allows or denies. </li>
<li>Condition—The condition value optionally defines one or more additional restrictions that limit the actions allowed by the permission.</li>
</ul>
<p>A Sample policy:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"Version"</span>: <span class="string">"2012–10–17"</span>,</span><br><span class="line">    <span class="attr">"Statement"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"Sid"</span>: <span class="string">"Stmt1441716043000"</span>,</span><br><span class="line">            "Effect": "Allow",	&lt;-  This policy grants access</span><br><span class="line">            "Action": [	&lt;-  Allows identities to list</span><br><span class="line">                "s3:GetObject",	&lt;-  and get objects in</span><br><span class="line">                "s3:ListBucket"	&lt;-  the S3 bucket</span><br><span class="line">            ],</span><br><span class="line">            "Condition": &#123;</span><br><span class="line">                "IpAddress": &#123;				&lt;-  Only from a specific</span><br><span class="line">                    "aws:SourceIp": "192.168.0.1"	&lt;-  IP Address</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            "Resource": [</span><br><span class="line">                "arn:aws:s3:::my_public_bucket/*"	&lt;-  Only this bucket</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="ASSOCIATING-POLICIES-WITH-PRINCIPALS"><a href="#ASSOCIATING-POLICIES-WITH-PRINCIPALS" class="headerlink" title="ASSOCIATING POLICIES WITH PRINCIPALS"></a>ASSOCIATING POLICIES WITH PRINCIPALS</h3><p>A policy can be associated directly with an IAM user in one of two ways:</p>
<ul>
<li>User Policy—These policies exist only in the context of the user to which they are attached. In the console, a user policy is entered into the user interface on the IAM user page.</li>
<li>Managed Policies—These policies are created in the Policies tab on the IAM page (or through the CLI, and so forth) and exist independently of any individual user. In this way, the same policy can be associated with many users or groups of users. There are a large number of predefined managed policies that you can review on the Policies tab of the IAM page in the AWS Management Console. In addition, you can write your own policies specific to your use cases.</li>
</ul>
<p>The other common method for associating policies with users is with the IAM groups feature. Groups simplify managing permissions for large numbers of users. After a policy is assigned to a group, any user who is a member of that group assumes those permissions.</p>
<p>There are two ways a policy can be associated with an IAM group:</p>
<ul>
<li>Group Policy—These policies exist only in the context of the group to which they are attached. In the AWS Management Console, a group policy is entered into the user interface on the IAM Group page.</li>
<li>Managed Policies—In the same way that managed policies (discussed in the “Authorization” section) can be associated with IAM users, they can also be associated with IAM groups.</li>
</ul>
<p>The final way an actor can be associated with a policy is by assuming a role. In this case, the actor can be:</p>
<ul>
<li>An authenticated IAM user (person or process). In this case, the IAM user must have the rights to assume the role.</li>
<li>A person or process authenticated by a trusted service outside of AWS, such as an on-premises LDAP directory or a web authentication service. In this situation, an AWS Cloud service will assume the role on the actor’s behalf and return a token to the actor.</li>
</ul>
<p>After an actor has assumed a role, it is provided with a temporary security token associated with the policies of that role. The token contains all the information required to authenticate API calls. This information includes a standard access key plus an additional session token required for authenticating calls under an assumed role.</p>
<h2 id="Other-Key-Features"><a href="#Other-Key-Features" class="headerlink" title="Other Key Features"></a>Other Key Features</h2><h3 id="MULTI-FACTOR-AUTHENTICATION-MFA"><a href="#MULTI-FACTOR-AUTHENTICATION-MFA" class="headerlink" title="MULTI-FACTOR AUTHENTICATION (MFA)"></a>MULTI-FACTOR AUTHENTICATION (MFA)</h3><h2 id="ROTATING-KEYS"><a href="#ROTATING-KEYS" class="headerlink" title="ROTATING KEYS"></a>ROTATING KEYS</h2><h2 id="RESOLVING-MULTIPLE-PERMISSIONS"><a href="#RESOLVING-MULTIPLE-PERMISSIONS" class="headerlink" title="RESOLVING MULTIPLE PERMISSIONS"></a>RESOLVING MULTIPLE PERMISSIONS</h2><ol>
<li>Initially the request is denied by default.</li>
<li>All the appropriate policies are evaluated; if there is an explicit “deny” found in any policy, the request is denied and evaluation stops.</li>
<li>If no explicit “deny” is found and an explicit “allow” is found in any policy, the request is allowed.</li>
<li>If there are no explicit “allow” or “deny” permissions found, then the default “deny” is maintained and the request is denied.</li>
</ol>
<p>The only exception to this rule is if an AssumeRole call includes a role and a policy, the policy cannot expand the privileges of the role (for example, the policy cannot override any permission that is denied by default in the role).</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloud/">cloud</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aws/">aws</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cloud/">cloud</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-aws" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/16/aws/" class="article-date">
  <time datetime="2018-06-16T02:50:58.000Z" itemprop="datePublished">2018-06-16</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/16/aws/">AWS</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><h2 id="Cloud-computing-deployment-modes"><a href="#Cloud-computing-deployment-modes" class="headerlink" title="Cloud computing deployment modes"></a>Cloud computing deployment modes</h2><ul>
<li>all-in cloud-based application deployment</li>
<li>hybrid deployment</li>
</ul>
<h2 id="Regions-Availability-Zones-and-Edge-locations"><a href="#Regions-Availability-Zones-and-Edge-locations" class="headerlink" title="Regions, Availability Zones and Edge locations"></a>Regions, Availability Zones and Edge locations</h2><ul>
<li>AWS Management Console</li>
<li>CLI</li>
<li>SDKs</li>
</ul>
<p>AWS provides a highly available technology infrastructure platform with multiple locations worldwide. These locations are composed of regions and Availability Zones. Each <strong>region</strong> is a separate geographic area. Each region has multiple, isolated locations known as Availability Zones. AWS enables the placement of resources and data in multiple locations. Resources aren’t replicated across regions unless organizations choose to do so.</p>
<p>Each region is completely independent and is designed to be completely isolated from the other regions. This achieves the greatest possible fault tolerance and stability. Each <strong>Availability Zone</strong> is also isolated, but the Availability Zones in a region are connected through low-latency links.</p>
<p>An <strong>Edge location</strong> is a CDN or Content Delivery Network endpoint for CloudFront.</p>
<h2 id="ACCESSING-THE-PLATFORM"><a href="#ACCESSING-THE-PLATFORM" class="headerlink" title="ACCESSING THE PLATFORM"></a>ACCESSING THE PLATFORM</h2><h1 id="Topics"><a href="#Topics" class="headerlink" title="Topics"></a>Topics</h1><p><a href="aws-security.md">Security</a></p>
<p><a href="aws-networking.md">Networking</a></p>
<p><a href="aws-computing.md">Computing</a></p>
<p><a href="aws-storage.md">Storage</a></p>
<p><a href="aws-database.md">Database</a></p>
<p><a href="aws-analytics.md">Analytics</a></p>
<p><a href="aws-developer-management-tool.md">Developer and Management Tool</a></p>
<p><a href="aws-mobile-application-services.md">Mobile and Application Services</a></p>
<p><a href="aws-high-availability-fault-tolerance.md">High Availability and Fault Tolerance</a></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloud/">cloud</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aws/">aws</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cloud/">cloud</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-hyperledger-overview" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/14/hyperledger-overview/" class="article-date">
  <time datetime="2018-06-14T11:34:54.000Z" itemprop="datePublished">2018-06-14</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/14/hyperledger-overview/">hyperledger-overview</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Hyperledger Fabric 是 IBM 贡献给 Linux 基金会的商用分布式账本系统，自项目创立伊始就吸引了金融、银行、互联网、传统行业领域的巨头们的眼光。</p>
<p>Hyperledger Fabric 是基于 Golang 实现的可插拔的区块链系统，它主要面向企业之间或者企业多个部门之间提供服务。</p>
<p><img src="architecture.jpg" alt="Architecture"></p>
<ul>
<li>Membership 即成员管理服务，提供身份管理、证书校验。在 Fabric 中每个通讯组件都必须提供身份证明，每个事务的发起者会被永久记录在区块链上，审核人员可以追溯事务。</li>
<li>Blockchain Services 即区块链服务，提供分布式一致性算法，维护全网数据一致，提供账本存储服务，基于 P2P 网络实现节点之间的通讯。</li>
<li>Chaincode Services 即链码服务，智能合约在 Fabric 中称为链码。链码是操作状态数据库的唯一方法，大部分事务都是通过链码完成的。该部分提供链码的部署和运行环境。</li>
</ul>
<h1 id="区块链"><a href="#区块链" class="headerlink" title="区块链"></a>区块链</h1><p>区块链是一种<strong>分布式多写</strong>的、<strong>防篡改</strong>的<strong>数据库</strong></p>
<h2 id="分布式多写"><a href="#分布式多写" class="headerlink" title="分布式多写"></a>分布式多写</h2><h3 id="共识算法"><a href="#共识算法" class="headerlink" title="共识算法"></a>共识算法</h3><p>多写一定要保证数据最终一致性；也搞清楚解决问题的办法——通过“固定的”规则决定顺序，节点中的所有服务器只要遵循这个规则那么数据最终一定一致。</p>
<h3 id="拜占庭将军和-PBFT"><a href="#拜占庭将军和-PBFT" class="headerlink" title="拜占庭将军和 PBFT"></a>拜占庭将军和 PBFT</h3><p>拜占庭将军问题是要解决在一个消息可能丢失、重复、伪造的环境达到数据一致问题。</p>
<p>接下来看 Practical Byzantine Fault Tolerance（PBFT）算法，它的过程如下：</p>
<ol>
<li>从全网节点选举出一个主节点，新区块由主节点负责生成。</li>
<li>每个节点把新交易向全网广播，主节点把从网络收集到需放在新区块内的多个交易排序后存入列表，并将该列表向全网广播。</li>
<li>每个节点接收到交易列表后，依据排序模拟执行交易。所有交易执行完后，基于交易结果计算新区块的哈希摘要，并向全网广播。</li>
<li>如果一个节点收到的 2f（f 为可容忍的恶意节点数）条其它节点发来的摘要都和自己相同，就向全网广播一条 commit 消息。</li>
<li>如果一个节点收到 2f+1 条 commit 消息， 即可正式提交新区块及其交易到本地的区块链和状态数据库。</li>
</ol>
<p>PBFT只适合于内部使用（联盟链或者私有链），因为互联网上不太可能确定“全网排序节点”。</p>
<h3 id="防篡改"><a href="#防篡改" class="headerlink" title="防篡改"></a>防篡改</h3><p><img src="merkle tree.jpg" alt="Merkle Tree"></p>
<p>所有的数据（事务）都放在二叉树的叶子节点，非叶子节点是其对应子节点的 Hash 值。当数据发生变化会引起非叶子节点的连环变化，最终引起 Root 的变化。</p>
<p>区块链的底层存储是一个链表，包括区块头和区块体。头部是一个链表结构，分别是前一块的 Hash 值、Merkle Root、本数据块的 Hash 值（Nonce)；区块体是一个树结构，叶子节点是事务（Tx），其他节点是下级节点的 Hash 值，最终树根的 Hash 值就叫 Merkle Root，放在头部。</p>
<p><img src="block.jpg" alt="Blocks"></p>
<p>所以如果要篡改某个区块必须把该区块的所有前驱都给修改掉，修改比较麻烦——注意不是不能修改</p>
<p>对于比特币来说仅仅做到这一点是不够的，它毕竟是数字货币，利益诱惑比较大。所以比特币设计了两个门槛：</p>
<ul>
<li>最新的前驱节点（最新的数据块）不一定被篡改者算出来，除非计算能力特别强大；</li>
<li>区块的 Hash 值是特殊的，PoW 中的“Hash 游戏”是寻找一种特别的 Hash 值，只能通过不断遍历才可能算出这个值，这也是“工作量”体现。所以重新计算 Hash 值相当于重新进行工作量计算，这个计算开销也非常巨大。相当于把整个链上的区块全部重新算一遍。</li>
</ul>
<h1 id="Hyperledger-和-Fabric"><a href="#Hyperledger-和-Fabric" class="headerlink" title="Hyperledger 和 Fabric"></a>Hyperledger 和 Fabric</h1><p>Hyperledger 是一个开放源代码的区块链和相关工具的总括项目，由 Linux 基金会管理。Fabric 是一个商用分布式账本，它最早由 IBM 和 Digital Asset 贡献给了 Hyperledger 项目。它主要用于“企业内部使用”，技术架构选择了和比特币、以太坊完全不同的策略。</p>
<h2 id="Fabric-的共识设计"><a href="#Fabric-的共识设计" class="headerlink" title="Fabric 的共识设计"></a>Fabric 的共识设计</h2><p>Fabric 被设计为一个数据存储系统，写入速度是一个非常重要的性能指标，所以不可能采用 PoW 算法。</p>
<p>共识就是要解决排序问题</p>
<p>Fabric 采用了一个很简单、粗暴，而又充满工程化考虑的设计方案——排序节点（PBFT 算法）。在整个网络中有一个或者一组节点充当排序节点，其他节点都按照排序节点给出的顺序进行数据写入，完整的过程如下图所示。</p>
<p><img src="pbft.jpg" alt="PBFT"></p>
<p>应用程序首先向所有 Peer 节点（也有文档叫背书节点、记账节点）发起“记账要求”（Proposal）；每个节点把数据记录下来——此时还没有提交到状态数据库（没有生效），然后返回应用程序一个“事务签名”（Proposal Response）；应用程序把“事务签名”发送给排序服务器，排序服务器可能同时收到很多事务，按照一定规则给出事务的顺序，发送给记账节点；记账节点在收到排序服务器的顺序后会校验一下“事务签名”确定是自己给出的票然后更新状态数据库，数据生效。这个过程可以简单的归纳为投票 -&gt; 排序 -&gt; 验证。</p>
<p>排序服务器排序的规则有两种，SOLO 和 Kafka 。可以把 SOLO 机制理解为单机版的队列，排序服务器按收到的顺序依次放入队列。SOLO 的性能并不高，在开发环境中用这种机制，生产环境建议使用“真刀真枪的 MQ”——Kafka。</p>
<h2 id="Fabric-的防篡改机制"><a href="#Fabric-的防篡改机制" class="headerlink" title="Fabric 的防篡改机制"></a>Fabric 的防篡改机制</h2><p>比特币防篡改的机制是基于 PoW 精心设计的，如果要修改数据那么必须“算力足够”，所以比特币的一切都是围绕 PoW 设计，而设计目标则是——发币。对于没有采用 PoW 的 Fabric 来说防篡改机制必须另谋出路。</p>
<p>这个“出路”其实不是技术考虑，更多的是业务场景考虑。Fabric 主要面向内部使用（联盟链或者私有链）“内部环境”比较容易实现“审计机制”，我们可以通过 Fabric 的 Event 记录整个系统的运行过程，当数据不一致的时候通过“审计机制”发现谁的数据有问题（需要人工介入）然后把它“踢”出去。简单来说——Fabric 的防篡改是“人肉审计”机制。</p>
<p>Fabric 提供一个模块化的构架，其中的节点、智能合约、共识机制、成员服务都是模块化，可扩展的。如果开发者觉得 Fabric 的设计策略不适合，那么可以做相关的扩展开发。</p>
<h3 id="Fabric-基本概念"><a href="#Fabric-基本概念" class="headerlink" title="Fabric 基本概念"></a>Fabric 基本概念</h3><ul>
<li>Channel，一个“链”。可以理解为一个数据库。以太坊、比特币它们都属于“单链”，Fabric 可以同时运行多个链。</li>
<li>Chaincode，链码。区块链上的数据改变都是通过智能合约操作的，在 Fabric 中智能合约叫 ChainCode。</li>
<li>Fabric 网络，在 Fabric 中组成区块链系统的各个进程组成的通讯网络叫 Fabric 网络。<br>Fabric 网络可以是由一个物理节点组成，也可以由多个不同的物理节点组成。一般在开发环境中运行在同一个物理节点上（开发者自己的机器），在生产环境中需要根据组织或者部门在不同的节点上启动相关进程。</li>
</ul>
<p>Fabric 提供了各个平台的二进制文件，但是一般不直接使用这些二进制文件，而是通过容器的方式部署系统。</p>
<p>锚节点 Peer （Anchor peer）</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/blockchain/">blockchain</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hyperledger/">hyperledger</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-kubectl" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/13/kubectl/" class="article-date">
  <time datetime="2018-06-13T10:51:25.000Z" itemprop="datePublished">2018-06-13</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/13/kubectl/">kubectl</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Frequently-Used-Commands"><a href="#Frequently-Used-Commands" class="headerlink" title="Frequently Used Commands"></a>Frequently Used Commands</h1><p>cd ~/workspace/infrastructure-kubernetes-client-config<br>./cluster.sh development</p>
<p>k config use-context production</p>
<p>k get namespaces</p>
<p>k get pod -n api-content-production-v1</p>
<p>k logs -n api-content-production-v1 api-content-12-03k</p>
<p>kubectl –namespace=<namespace> exec -it <pod name=""> sh</pod></namespace></p>
<p>k logs -n api-content-production-v1 api-content-12-03k -p</p>
<p>k logs -n api-content-production-v1 api-content-12-03k -f </p>
<p>k logs [name] | grep p4yvsf –since=14h</p>
<p>kubectl -n=pusher-content-capi-production-v1 logs lqudo-blue-app-1991648162-cnr97 | grep ExportFailure</p>
<p>k get deploy -n api-content-development-v1</p>
<p>k scale deploy -n api-content-development-v1 api-content —replicas=1</p>
<p>k describe pod -n api-content-development-v1 a-edf-pod-name</p>
<p>k get node</p>
<p>k get node —all-namespaces | grep -v Running</p>
<p>k get ing –all-namespaces</p>
<p>kubectl -n loader-content-capi-development-v1 get secrets -o yaml</p>
<p>echo “&lt;encoded_secret_value&gt;” | base64 –decode</p>
<p>In the node:</p>
<p>apk –no-cache add postgresql-client<br>psql $DATABASE_URL<br>\dt to list table<br>\q to quit</p>
<p>psql $DB_URL -t -A -F”,” -o &lt;csv_file_name&gt; -c “&lt;sql_query&gt;”</p>
<p>kubectl –n=<namespace> cp <podname>:&lt;file_name_on_pod&gt; &lt;local_file_name&gt;</podname></namespace></p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://kubernetes.io/docs/user-guide/kubectl-cheatsheet/" target="_blank" rel="noopener">https://kubernetes.io/docs/user-guide/kubectl-cheatsheet/</a></li>
<li><a href="https://github.com/feiskyer/kubernetes-handbook" target="_blank" rel="noopener">https://github.com/feiskyer/kubernetes-handbook</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/devops/">devops</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-kubernetes-system" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/13/kubernetes-system/" class="article-date">
  <time datetime="2018-06-13T09:29:09.000Z" itemprop="datePublished">2018-06-13</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/13/kubernetes-system/">Kubernetes System</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
			<h1 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h1><p>A cluster is a set of physical or virtual machines (or both) combined with other infrastructure resources used by Kubernetes to run your applications.</p>
<p><code>kubectl cluster-info</code></p>
<p><img src="kubernetes architectural overview.png" alt="Kubernetes Architectural Overview"><br><img src="kubernetes architecture.png" alt="Kubernetes Architecture"></p>
			
				<p class="article-more-link">
					<a href="/2018/06/13/kubernetes-system/#more">Read More</a>
				</p>
      
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/devops/">devops</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-kubernetes-advanced" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/13/kubernetes-advanced/" class="article-date">
  <time datetime="2018-06-13T09:27:32.000Z" itemprop="datePublished">2018-06-13</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/13/kubernetes-advanced/">Kubernetes Advanced</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
			<h1 id="Service-Discovery"><a href="#Service-Discovery" class="headerlink" title="Service Discovery"></a>Service Discovery</h1><p>Kubernetes 里服务发现有多种方式：</p>
<ol>
<li><p>通过环境变量注入发现服务。<br>当 Pods 在集群的 Node 中运行时，Kubernetes 会为它增加一些列的环境变量。</p>
</li>
<li><p>通过 Kubernetes DNS 服务器。<br>Kubernetes DNS 服务器会订阅 Kubernetes API创建 Service 的事件，并且为每个 Service 记录一个 DNS 的记录。这样做的好处是：只要 DNS 服务在集群里有访问权限，那么所有的 Pods 都能访问新注册的 Service。举例：如果你有一个 Service 在 Kubernetes Namespace “my-ns”下 ，名字叫做叫 “my-service”，那么一条叫做”my-service.my-ns”的记录就会被创建。所有在”my-ns” Namespace 里的 Pods 都能通过 DNS 查找到”my-service”。</p>
</li>
</ol>
			
				<p class="article-more-link">
					<a href="/2018/06/13/kubernetes-advanced/#more">Read More</a>
				</p>
      
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/devops/">devops</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-kubernetes-overview" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/12/kubernetes-overview/" class="article-date">
  <time datetime="2018-06-12T12:38:21.000Z" itemprop="datePublished">2018-06-12</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/12/kubernetes-overview/">Kubernetes Overview</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
			<h1 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h1><p>Docker -&gt; Docker Compose -&gt; Kubernetes</p>
<p>光靠 Compose 肯定不够，因为 Compose 仅仅解决了应用的描述，运行的问题，但应用的编排，服务注册，服务发现，服务监控，故障恢复，DNS，负载均衡等等功能如何实现？ </p>
<p>Docker 的作用是计算资源和环境的描述和调度，Kubernetes 的作用是以应用为中心的生命周期的管理。</p>
<p>Kubernetes provides mechanisms for application deployment, scheduling, updating, maintenance, and scaling. A key feature of Kubernetes is that it actively manages the containers to ensure the state of the cluster continually matches the user’s intentions.</p>
<p>To provide reliable and scalable distributed system.</p>
<p>Benefits</p>
<ul>
<li>immutability</li>
<li>declarative configuration</li>
<li>self-healing</li>
<li>easy scaling</li>
<li>decoupling applications</li>
<li>health-checking</li>
<li>rollouts</li>
</ul>
<p>Managed KaaS services</p>
			
				<p class="article-more-link">
					<a href="/2018/06/12/kubernetes-overview/#more">Read More</a>
				</p>
      
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/devops/">devops</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-helm" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/11/helm/" class="article-date">
  <time datetime="2018-06-11T13:04:25.000Z" itemprop="datePublished">2018-06-11</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/11/helm/">Helm</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
			<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Helm is a package manager for Kubernetes applications.</p>
<p>Helm packages all of the different Kubernetes resources (such as deployments, services, and ingress) into a chart, which may be hosted in a repository.</p>
<p>Users can pull down charts and install them on any number of Kubernetes clusters.</p>
<p>Helm’s approach scales from monoliths to complex micro service applications. </p>
<p>Helm itself uses a client-server model. The helm command (the client) talks to the tiller  (the server). The Helm client may interact with any number of different tiller services. In practice, there is a single tiller service running one Kubernetes cluster. This helps teams collaborate. It also means that Helm may run anywhere, such as on your CI servers or on your own computer. Tiller does the work to coordinate with Kubernetes and get the chart installed.</p>
			
				<p class="article-more-link">
					<a href="/2018/06/11/helm/#more">Read More</a>
				</p>
      
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/devops/">devops</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/devops/">devops</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/helm/">helm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kubernetes/">kubernetes</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-code-review-checklist" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/10/code-review-checklist/" class="article-date">
  <time datetime="2018-06-10T12:18:40.000Z" itemprop="datePublished">2018-06-10</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/10/code-review-checklist/">Code Review Checklist</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Checklist"><a href="#Checklist" class="headerlink" title="Checklist"></a>Checklist</h1><ol>
<li>Are all requirements implemented?</li>
<li>Single responsibility of a single PR. No mixed changes.</li>
<li>Is the code change the best way to implement the feature?</li>
<li>Are there any regression issues introduced in the existing features?</li>
<li>If it’s a breaking change, is it well communicated?</li>
<li>Is the code change complete?<ol>
<li>Documents updated</li>
<li>Migration included</li>
<li>Configurations updated</li>
<li>Other systems updated/notified</li>
<li>Infrastructure(Database, etc.)</li>
<li>Non-functional requirements<ol>
<li>Metrics</li>
<li>Tracing</li>
<li>Logging</li>
</ol>
</li>
</ol>
</li>
<li>Are there any major issues found?<ol>
<li>Performance</li>
<li>Security</li>
<li>Thread safe</li>
<li>Edge cases</li>
</ol>
</li>
<li>Are errors are gracefully handled?</li>
<li>Are there sufficient level of unit tests/e2e tests?</li>
<li>Is the code change generally readable?<ol>
<li>Can I get an understanding of the desired behavior just by doing quick scans through unit and acceptance tests?</li>
<li>Do the methods do what the name of the method claims that they’ll do? Same for classes?</li>
<li>Method is too long</li>
<li>Method has too many parameters</li>
<li>Deeply nested if/else controls</li>
</ol>
</li>
<li>Are general coding best practices followed?<ol>
<li>No hard coded stuff</li>
<li>No duplications</li>
<li>Separate of concerns</li>
<li>Easy to extend</li>
<li>Comments</li>
<li>Naming convention followed</li>
</ol>
</li>
</ol>
<h1 id="General-Rules"><a href="#General-Rules" class="headerlink" title="General Rules"></a>General Rules</h1><ol>
<li>Automating the Easy Stuff<ol>
<li>Lint</li>
<li>Test coverage</li>
<li>Git hooks</li>
</ol>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol>
<li><a href="https://medium.com/@mrjoelkemp/giving-better-code-reviews-16109e0fdd36" target="_blank" rel="noopener">https://medium.com/@mrjoelkemp/giving-better-code-reviews-16109e0fdd36</a></li>
<li><a href="https://github.com/thoughtbot/guides/tree/master/code-review#code-review" target="_blank" rel="noopener">https://github.com/thoughtbot/guides/tree/master/code-review#code-review</a></li>
<li><a href="https://github.com/joho/awesome-code-review" target="_blank" rel="noopener">https://github.com/joho/awesome-code-review</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/tech-leadership/">tech leadership</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/code-review/">code review</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-highly-effective-workspace" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/10/highly-effective-workspace/" class="article-date">
  <time datetime="2018-06-10T10:09:59.000Z" itemprop="datePublished">2018-06-10</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/10/highly-effective-workspace/">Highly Effective Workspace with Macbook</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
			<h1 id="MacOS"><a href="#MacOS" class="headerlink" title="MacOS"></a>MacOS</h1><ul>
<li>将功能键(F1-F12)设置为标准的功能键</li>
<li>设置Trackpad（触摸板）轻触为单击</li>
<li>将Dock停靠在屏幕左边</li>
<li>全键盘控制模式</li>
<li>快速锁定屏幕</li>
</ul>
<h1 id="VSC"><a href="#VSC" class="headerlink" title="VSC"></a>VSC</h1><ul>
<li>sync settings to Github gist</li>
<li>code snippets</li>
<li>shortcuts</li>
<li>vim mode</li>
<li>create case-sensitive workspace<ul>
<li>hdiutil create -type SPARSE -fs ‘Case-sensitive Journaled HFS+’ -size 100g -volname workspace ~/Documents/workspace.dmg.sparseimage</li>
</ul>
</li>
<li>code snippets<ul>
<li>ctrl + space</li>
<li>User Snippets by language filter</li>
</ul>
</li>
</ul>
			
				<p class="article-more-link">
					<a href="/2018/06/10/highly-effective-workspace/#more">Read More</a>
				</p>
      
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/other/">other</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vsc/">vsc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zsh/">zsh</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:superliuwr.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">SUPERLOG</a>
	</h1>
	<span class="copyright">
		&copy; 2018 Marvin Liu<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>