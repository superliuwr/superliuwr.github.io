<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SUPERLOG</title>
  <meta name="viewport" content="width=device-width">
  <meta property="og:type" content="website">
<meta property="og:title" content="SUPERLOG">
<meta property="og:url" content="http://superliuwr.github.io/index.html">
<meta property="og:site_name" content="SUPERLOG">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SUPERLOG">
  
    <link rel="alternative" href="/atom.xml" title="SUPERLOG" type="application/atom+xml">
  
  
    <link rel="icon" href="images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">SUPERLOG</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://superliuwr.github.io"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-aws-cloudfront" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/07/08/aws-cloudfront/" class="article-date">
  <time datetime="2018-07-08T11:41:35.000Z" itemprop="datePublished">2018-07-08</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/07/08/aws-cloudfront/">aws-cloudfront</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="AMAZON-CLOUDFRONT"><a href="#AMAZON-CLOUDFRONT" class="headerlink" title="AMAZON CLOUDFRONT"></a>AMAZON CLOUDFRONT</h1><p>Amazon CloudFront is a global Content Delivery Network (CDN) service. It integrates with other AWS products to give developers and businesses an easy way to distribute content to end users with low latency, high data transfer speeds, and no minimum usage commitments.</p>
<p>Amazon CloudFront is AWS CDN. It can be used to deliver your web content using Amazon’s global network of <em>edge locations</em>.</p>
<p>Amazon CloudFront is optimized to work with other AWS cloud services as the origin server, including Amazon S3 buckets, Amazon S3 static websites, Amazon Elastic Compute Cloud (Amazon EC2), and Elastic Load Balancing. Amazon CloudFront also works seamlessly with any non-AWS origin server, such as an existing on-premises web server. Amazon CloudFront also integrates with Amazon Route 53.</p>
<p>Amazon CloudFront supports all content that can be served over HTTP or HTTPS. This includes any popular static files that are a part of your web application, such as HTML files, images, JavaScript, and CSS files, and also audio, video, media files, or software downloads. Amazon CloudFront also supports serving dynamic web pages, so it can actually be used to deliver your entire website. Finally, Amazon CloudFront supports media streaming, using both HTTP and RTMP.</p>
<h2 id="Distributions"><a href="#Distributions" class="headerlink" title="Distributions"></a>Distributions</h2><p>To use Amazon CloudFront, you start by creating a distribution, which is identified by a DNS domain name such as d111111abcdef8.cloudfront.net.</p>
<p>You can use the Amazon CloudFront distribution domain name as-is, or you can create a user-friendly DNS name in your own domain by creating a CNAME record in Amazon Route 53 or another DNS service. The CNAME is automatically redirected to your Amazon CloudFront distribution domain name.</p>
<h2 id="Origins"><a href="#Origins" class="headerlink" title="Origins"></a>Origins</h2><p>When you create a distribution, you must specify the DNS domain name of the origin—the Amazon S3 bucket or HTTP server—from which you want Amazon CloudFront to get the definitive version of your objects (web files).</p>
<p>For example:</p>
<ul>
<li>Amazon S3 bucket: myawsbucket.s3.amazonaws.com</li>
<li>Amazon EC2 instance: ec2–203–0–113–25.compute-1.amazonaws.com</li>
<li>Elastic Load Balancing load balancer: my-load-balancer-1234567890.us-west-2.elb.amazonaws.com</li>
<li>Website URL: mywebserver.mycompanydomain.com</li>
</ul>
<h2 id="cache-control"><a href="#cache-control" class="headerlink" title="cache control"></a>cache control</h2><p>Once requested and served from an edge location, objects stay in the cache until they expire or are evicted to make room for more frequently requested content. By default, objects expire from the cache after 24 hours.</p>
<p>Optionally, you can control how long objects stay in an Amazon CloudFront cache before expiring. To do this, you can choose to use Cache-Control headers set by your origin server or you can set the minimum, maximum, and default Time to Live (TTL) for objects in your Amazon CloudFront distribution.</p>
<p>You can also remove copies of an object from all Amazon CloudFront edge locations at any time by calling the invalidation Application Program Interface (API).</p>
<p>Instead of invalidating objects manually or programmatically, it is a best practice to use a version identifier as part of the object (file) path name. For example:</p>
<ul>
<li>Old file: assets/v1/css/narrow.css</li>
<li>New file: assets/v2/css/narrow.css</li>
</ul>
<h2 id="Dynamic-Content-Multiple-Origins-and-Cache-Behaviors"><a href="#Dynamic-Content-Multiple-Origins-and-Cache-Behaviors" class="headerlink" title="Dynamic Content, Multiple Origins, and Cache Behaviors"></a>Dynamic Content, Multiple Origins, and Cache Behaviors</h2><p>Serving static assets, such as described previously, is a common way to use a CDN. An Amazon CloudFront distribution, however, can easily be set up to serve dynamic content in addition to static content and to use more than one origin server. You control which requests are served by which origin and how requests are cached using a feature called cache behaviors.</p>
<p>A cache behavior lets you configure a variety of Amazon CloudFront functionalities for a given URL path pattern for files on your website.</p>
<p>The functionality you can configure for each cache behavior includes the following:</p>
<ul>
<li>The path pattern</li>
<li>Which origin to forward your requests to</li>
<li>Whether to forward query strings to your origin</li>
<li>Whether accessing the specified files requires signed URLs</li>
<li>Whether to require HTTPS access</li>
<li>The amount of time that those files stay in the Amazon CloudFront cache (regardless of the value of any Cache-Control headers that your origin adds to the files)</li>
</ul>
<h2 id="Private-Content"><a href="#Private-Content" class="headerlink" title="Private Content"></a>Private Content</h2><p>In many cases, you may want to restrict access to content in Amazon CloudFront to only selected requestors, such as paid subscribers or to applications or users in your company network. Amazon CloudFront provides several mechanisms to allow you to serve private content. These include:</p>
<ul>
<li><p>Signed URLs Use URLs that are valid only between certain times and optionally from certain IP addresses.</p>
</li>
<li><p>Signed Cookies Require authentication via public and private key pairs.</p>
</li>
<li><p>Origin Access Identities (OAI) Restrict access to an Amazon S3 bucket only to a special Amazon CloudFront user associated with your distribution. This is the easiest way to ensure that content in a bucket is only accessed by Amazon CloudFront.</p>
</li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Cloud/">Cloud</a>»<a class="article-category-link" href="/categories/Cloud/DevOps/">DevOps</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AWS/">AWS</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-nodejs-error-handling" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/07/01/nodejs-error-handling/" class="article-date">
  <time datetime="2018-07-01T01:09:47.000Z" itemprop="datePublished">2018-07-01</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/07/01/nodejs-error-handling/">Node.js Error Handling Best Practices</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node-js/">Node.js</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Best-Practices/">Best Practices</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Error-Handling/">Error Handling</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-nodejs-logging" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/07/01/nodejs-logging/" class="article-date">
  <time datetime="2018-07-01T00:04:37.000Z" itemprop="datePublished">2018-07-01</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/07/01/nodejs-logging/">Node.js Logging Best Practices</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p> Logs can be a dumb warehouse of debug statements or the enabler of a beautiful dashboard that tells the story of your app. Plan your logging platform from day 1: how logs are collected, stored and analyzed to ensure that the desired information (e.g. error rate, following an entire transaction through services and servers, etc) can really be extracted.</p>
<h2 id="Bunyan"><a href="#Bunyan" class="headerlink" title="Bunyan"></a>Bunyan</h2><p>Use <a href="https://github.com/trentm/node-bunyan" target="_blank" rel="noopener">Bunyan</a> to log structured records. Alternatively you can use <a href="https://www.npmjs.com/package/pino" target="_blank" rel="noopener">pino</a>.</p>
<p>Bunyan log records are JSON. A few fields are added automatically: “pid”, “hostname”, “time” and “v”.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Log with an optional 'fields' object as the first parameter</span></span><br><span class="line">log.info(&#123;<span class="attr">foo</span>: <span class="string">'bar'</span>, <span class="attr">err</span>: err&#125;, <span class="string">'some msg about this error'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Child-Logger"><a href="#Child-Logger" class="headerlink" title="Child Logger"></a>Child Logger</h3><p>Bunyan has a concept of a child logger to specialize a logger for a sub-component of your application, i.e. to create a new logger with additional bound fields that will be included in its log records. A child logger is created with <code>log.child(...)</code>.</p>
<p>Bunyan has a concept of “serializer” functions to produce a JSON-able object from a JavaScript object, so you can easily do the following:</p>
<p><code>log.info({req: &lt;request object&gt;}, &#39;something about handling this request&#39;);</code></p>
<p>and have the req entry in the log record be just a reasonable subset of <request object=""> fields (or computed data about those fields).</request></p>
<h2 id="收集渠道"><a href="#收集渠道" class="headerlink" title="收集渠道"></a>收集渠道</h2><ol>
<li><p>系统未捕获错误:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">process.on(<span class="string">'uncaughtException'</span>, processErrorHandler);  </span><br><span class="line">process.on(<span class="string">'unhandledRejection'</span>, processErrorHandler);</span><br></pre></td></tr></table></figure>
</li>
<li><p>程序内 byLog 的输出</p>
</li>
<li>console.error</li>
</ol>
<p>针对 Express 可做如下埋点:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在所有路由最后，添加错误处理，必须同时含有四个参数</span></span><br><span class="line"><span class="comment">// http://expressjs.com/en/guide/error-handling.html</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">err, req, res, next</span>) </span>&#123;  </span><br><span class="line">    res.send(&#123;</span><br><span class="line">        code: <span class="number">500</span>,</span><br><span class="line">        message: <span class="string">`System Error! Please send serial number <span class="subst">$&#123;req.x_request_id&#125;</span> to administer`</span></span><br><span class="line">    &#125;);</span><br><span class="line">    byLog.error(err, <span class="literal">null</span>, &#123;</span><br><span class="line">        req_id: req.x_request_id</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Logging-in-Distributed-Systems"><a href="#Logging-in-Distributed-Systems" class="headerlink" title="Logging in Distributed Systems"></a>Logging in Distributed Systems</h2><h3 id="Have-an-Application-Instance-Identifier"><a href="#Have-an-Application-Instance-Identifier" class="headerlink" title="Have an Application Instance Identifier"></a>Have an Application Instance Identifier</h3><p>Use the <code>name</code> field in bunyan.</p>
<h3 id="Always-Use-UTC-Time"><a href="#Always-Use-UTC-Time" class="headerlink" title="Always Use UTC Time"></a>Always Use UTC Time</h3><h3 id="Adding-correlation-IDs"><a href="#Adding-correlation-IDs" class="headerlink" title="Adding correlation IDs"></a>Adding correlation IDs</h3><p>This ID has to be passed around in function calls, and it has to be sent to downstream services too.</p>
<h3 id="Using-Trace"><a href="#Using-Trace" class="headerlink" title="Using Trace"></a>Using Trace</h3><p><a href="https://trace.risingstack.com/" target="_blank" rel="noopener">https://trace.risingstack.com/</a></p>
<h2 id="Never-ever-log-credentials-passwords-or-any-sensitive-information"><a href="#Never-ever-log-credentials-passwords-or-any-sensitive-information" class="headerlink" title="Never, ever log credentials, passwords or any sensitive information."></a>Never, ever log credentials, passwords or any sensitive information.</h2><h2 id="Logging-in-NPM-modules"><a href="#Logging-in-NPM-modules" class="headerlink" title="Logging in NPM modules"></a>Logging in NPM modules</h2><p>Use the <a href="https://www.npmjs.com/package/debug" target="_blank" rel="noopener">debug</a> module.</p>
<p>By default, it will not produce any output. To enable this logger, you have run your application with a special environment variable, called DEBUG.</p>
<p><code>DEBUG=my-namespace,express* node app.js</code></p>
<p>Once you do that, the debug module will come to life and will start producing log events for stdout.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a href="https://blog.risingstack.com/node-js-logging-tutorial/" target="_blank" rel="noopener">How to Get Node.js Logging Right</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Node-js/">Node.js</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Best-Practices/">Best Practices</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Logging/">Logging</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-metrics-and-prometheus" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/29/metrics-and-prometheus/" class="article-date">
  <time datetime="2018-06-29T13:09:56.000Z" itemprop="datePublished">2018-06-29</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/29/metrics-and-prometheus/">Metrics, OpenTracing, Prometheus and Grafana</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Calling-chain"><a href="#Calling-chain" class="headerlink" title="Calling chain"></a>Calling chain</h1><p>一个完整的微服务系统包含多个微服务单元，各个微服务子系统存在互相调用的情况，形成一个 调用链。一个客户端请求从发出到被响应 经历了哪些组件、哪些微服务、请求总时长、每个组件所花时长 等信息我们有必要了解和收集，以帮助我们定位性能瓶颈、进行性能调优，因此监控整个微服务架构的调用链十分有必要。</p>
<h2 id="Zipkin"><a href="#Zipkin" class="headerlink" title="Zipkin"></a>Zipkin</h2>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Microservices/">Microservices</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/">DevOps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Grafana/">Grafana</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Metrics/">Metrics</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Microservices/">Microservices</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenTracing/">OpenTracing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Prometheus/">Prometheus</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-microservices-with-nodejs" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/28/microservices-with-nodejs/" class="article-date">
  <time datetime="2018-06-28T13:42:14.000Z" itemprop="datePublished">2018-06-28</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/28/microservices-with-nodejs/">Microservices with Node.js</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Microservices"><a href="#Microservices" class="headerlink" title="Microservices"></a>Microservices</h1><h2 id="Framework"><a href="#Framework" class="headerlink" title="Framework"></a>Framework</h2><h2 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h2><h2 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h2><h2 id="Service-Gateway"><a href="#Service-Gateway" class="headerlink" title="Service Gateway"></a>Service Gateway</h2><h2 id="Middlewares"><a href="#Middlewares" class="headerlink" title="Middlewares"></a>Middlewares</h2><h3 id="Pub-Sub"><a href="#Pub-Sub" class="headerlink" title="Pub/Sub"></a>Pub/Sub</h3><h3 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h3><h2 id="Authentication-and-Authorisation"><a href="#Authentication-and-Authorisation" class="headerlink" title="Authentication and Authorisation"></a>Authentication and Authorisation</h2><h2 id="Reliability"><a href="#Reliability" class="headerlink" title="Reliability"></a>Reliability</h2><h2 id="Health-Check"><a href="#Health-Check" class="headerlink" title="Health Check"></a>Health Check</h2><h2 id="Service-Registry-And-Discovery"><a href="#Service-Registry-And-Discovery" class="headerlink" title="Service Registry And Discovery"></a>Service Registry And Discovery</h2><h2 id="Load-Balancing"><a href="#Load-Balancing" class="headerlink" title="Load Balancing"></a>Load Balancing</h2><h2 id="Configuration-centre"><a href="#Configuration-centre" class="headerlink" title="Configuration centre"></a>Configuration centre</h2><h2 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h2><h2 id="Metrics"><a href="#Metrics" class="headerlink" title="Metrics"></a>Metrics</h2><h2 id="Monitoring"><a href="#Monitoring" class="headerlink" title="Monitoring"></a>Monitoring</h2><h2 id="Circuit-Breaker"><a href="#Circuit-Breaker" class="headerlink" title="Circuit Breaker"></a>Circuit Breaker</h2><h2 id="Distributed-Tracing"><a href="#Distributed-Tracing" class="headerlink" title="Distributed Tracing"></a>Distributed Tracing</h2><h1 id="Key-Points-to-validate"><a href="#Key-Points-to-validate" class="headerlink" title="Key Points to validate"></a>Key Points to validate</h1><ul>
<li>How many Microservices should I divide the business capabilities into thinking in terms of domain driven design.</li>
<li>Partitioning the data into different services with their own database solution with the understanding of which segment of data needs to be kept redundant locally for each of these services.</li>
<li>How data is synchronized between Microservices for redundant data.</li>
<li>Consistency requirements of data. (Whether its transactional requiring strong consistency vs possibility of implementing eventual consistency).</li>
<li>Selection of right interfaces, channels, and middleware for communications and interaction between services.</li>
<li>Required level of Security, Reliability, Performance, and Efficiency thinking the costs in mind.</li>
<li>Tools and technologies to be used for individual Microservices. (Serverless, Containers, Web Technologies &amp; etc.)</li>
<li>How to version and share code (If required) in the form of libraries using repositories like NPM.</li>
<li>How the teams and processes (Development, DevOps, Change Management &amp; etc.) are structured around Microservices.</li>
</ul>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Microservices/">Microservices</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Microservices/">Microservices</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-ci-cd-pipeline" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/28/ci-cd-pipeline/" class="article-date">
  <time datetime="2018-06-28T12:49:17.000Z" itemprop="datePublished">2018-06-28</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/28/ci-cd-pipeline/">CI, CD and Pipelines</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="What-are-CI-and-CD"><a href="#What-are-CI-and-CD" class="headerlink" title="What are CI and CD"></a>What are CI and CD</h1><p>Continuous Integration (CI) is a development practice that requires developers to integrate code into a shared repository several times a day. Each check-in is then verified by an automated build, allowing teams to detect problems early.</p>
<p>Continuous Delivery (CD) is the natural extension of Continuous Integration: an approach in which teams ensure that every change to the system is releasable, and that we can release any version at the push of a button. Continuous Delivery aims to make releases boring, so we can deliver frequently and get fast feedback on what users care about.</p>
<h1 id="持续集成应有的标准规范"><a href="#持续集成应有的标准规范" class="headerlink" title="持续集成应有的标准规范"></a>持续集成应有的标准规范</h1><ol>
<li>频繁提交</li>
<li>自动化测试</li>
<li>较短的构建和测试过程</li>
<li>本地开发环境与持续集成环境、测试环境、生产环境一致</li>
</ol>
<h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><ul>
<li>Github/Gitlab/Bitbucket</li>
<li>Buildkite/Jenkins/Codefresh/Codeship</li>
<li>Docker</li>
</ul>
<h1 id="发布策略"><a href="#发布策略" class="headerlink" title="发布策略"></a>发布策略</h1><p>Canary</p>
<h1 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h1>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/DevOps/">DevOps</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CD/">CD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CI/">CI</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-git" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/25/git/" class="article-date">
  <time datetime="2018-06-25T10:12:34.000Z" itemprop="datePublished">2018-06-25</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/25/git/">Advanced Git</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Important-concepts"><a href="#Important-concepts" class="headerlink" title="Important concepts"></a>Important concepts</h1><p><img src="./git concepts.jpg" alt="Git concepts"></p>
<h2 id="Repositories"><a href="#Repositories" class="headerlink" title="Repositories"></a>Repositories</h2><p>Git has two repository types: local and remote.  The local repo is on your computer for only your direct use.  The remote repo is typically elsewhere and for your indirect use.  Git supports multiple remote repositories.</p>
<h2 id="Committing-is-a-Multi-Step-Process"><a href="#Committing-is-a-Multi-Step-Process" class="headerlink" title="Committing is a Multi-Step Process"></a>Committing is a Multi-Step Process</h2><p>Git is a three step process to share your files with the team:</p>
<ol>
<li>Add. This copies new or updated files to the “stage” or “index” (you will see doc and info that use both terms).</li>
<li>Commit. This copies your staged files to the local repo.</li>
<li>Push. This copies your files from the local repo to the remote repo (only the changes the remote repos does not have).</li>
</ol>
<h2 id="File-Diffs-in-Workspace-Stage-and-Repo"><a href="#File-Diffs-in-Workspace-Stage-and-Repo" class="headerlink" title="File Diffs in Workspace, Stage, and Repo"></a>File Diffs in Workspace, Stage, and Repo</h2><p>Files can exist in three locations with Git.  The same file can have different content in each location:</p>
<ol>
<li>Committed in the repo: the HEAD version, the contents as the file was last committed.</li>
<li>Staged in the index: edits made or the file removed, added to the index, ready to commit.</li>
<li>Workspace: Work in progress (usually most files are unchanged, having the same content as the committed version).</li>
</ol>
<p>The Git diff command options allow comparing between the three locations (and more).</p>
<ul>
<li>Specifying no option compares the workspace to the staged/index version.</li>
<li>Specifying –cached or –staged compares the staged/index version with a committed version.</li>
<li>Additional diff options include comparing with any two files on disk, comparing two commits, and any file with any commit.</li>
</ul>
<h2 id="Scenario-based-Commands"><a href="#Scenario-based-Commands" class="headerlink" title="Scenario-based Commands"></a>Scenario-based Commands</h2><h3 id="远程操作"><a href="#远程操作" class="headerlink" title="远程操作"></a>远程操作</h3><h4 id="从远程主机克隆一个版本库"><a href="#从远程主机克隆一个版本库" class="headerlink" title="从远程主机克隆一个版本库"></a>从远程主机克隆一个版本库</h4><ul>
<li>git clone &lt;版本库的网址&gt;</li>
<li>git clone &lt;版本库的网址&gt; &lt;本地目录名&gt;</li>
<li>git clone –recursive git://github.com/foo/bar.git</li>
</ul>
<h4 id="管理主机名"><a href="#管理主机名" class="headerlink" title="管理主机名"></a>管理主机名</h4><ul>
<li>git remote</li>
<li>git remote -v</li>
<li>git remote show &lt;主机名&gt;</li>
<li>git remote add &lt;主机名&gt; &lt;网址&gt;</li>
</ul>
<h4 id="将远程主机的版本库更新取回本地"><a href="#将远程主机的版本库更新取回本地" class="headerlink" title="将远程主机的版本库更新取回本地"></a>将远程主机的版本库更新取回本地</h4><ul>
<li>git fetch &lt;远程主机名&gt;</li>
<li>git fetch &lt;远程主机名&gt; &lt;分支名&gt;</li>
</ul>
<p>git fetch命令通常用来查看其他人的进程，因为它取回的代码对你本地的开发代码没有影响。</p>
<p>所取回的更新，在本地主机上要用”远程主机名/分支名”的形式读取。比如origin主机的master，就要用origin/master读取。</p>
<h4 id="远程分支"><a href="#远程分支" class="headerlink" title="远程分支"></a>远程分支</h4><ul>
<li>git branch -r</li>
<li>git branch -a</li>
</ul>
<p>取回远程主机的更新以后，可以在它的基础上，使用git checkout命令创建一个新的分支:</p>
<ul>
<li>git checkout -b newBrach origin/master</li>
</ul>
<p>也可以使用git merge命令或者git rebase命令，在本地分支上合并远程分支:</p>
<ul>
<li>git merge origin/master</li>
<li>git rebase origin/master</li>
</ul>
<p>取回远程主机某个分支的更新，再与本地的指定分支合并:</p>
<ul>
<li>git pull &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;</li>
<li>git pull origin next 远程分支是与当前分支合并, 等同于先做git fetch，再做git merge</li>
</ul>
<p>在某些场合，Git会自动在本地分支与远程分支之间，建立一种追踪关系（tracking）。比如，在git clone的时候，所有本地分支默认与远程主机的同名分支，建立追踪关系，也就是说，本地的master分支自动”追踪”origin/master分支。</p>
<p>Git也允许手动建立追踪关系:</p>
<ul>
<li>git branch –set-upstream master origin/next</li>
</ul>
<p>如果当前分支与远程分支存在追踪关系，git pull就可以省略远程分支名:</p>
<ul>
<li>git pull origin</li>
</ul>
<p>如果当前分支只有一个追踪分支，连远程主机名都可以省略:</p>
<ul>
<li>git pull</li>
</ul>
<p>如果合并需要采用rebase模式，可以使用–rebase选项:</p>
<ul>
<li>git pull –rebase &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;</li>
</ul>
<p>加上参数 -p 就会在本地删除远程已经删除的分支:</p>
<ul>
<li>git pull -p</li>
</ul>
<p>将本地分支的更新，推送到远程主机:</p>
<ul>
<li>git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</li>
</ul>
<p>如果省略远程分支名，则表示将本地分支推送与之存在”追踪关系”的远程分支（通常两者同名），如果该远程分支不存在，则会被新建:</p>
<ul>
<li>git push origin master</li>
</ul>
<p>如果省略本地分支名，则表示删除指定的远程分支，因为这等同于推送一个空的本地分支到远程分支:</p>
<ul>
<li>git push origin :master</li>
</ul>
<p>如果当前分支与远程分支之间存在追踪关系，则本地分支和远程分支都可以省略:</p>
<ul>
<li>git push origin</li>
</ul>
<p>如果当前分支只有一个追踪分支，那么主机名都可以省略:</p>
<ul>
<li>git push</li>
</ul>
<p>如果当前分支与多个主机存在追踪关系，则可以使用-u选项指定一个默认主机，这样后面就可以不加任何参数使用git push:</p>
<ul>
<li>git push -u origin master</li>
</ul>
<p>将本地的所有分支都推送到远程主机:</p>
<ul>
<li>git push –all origin</li>
</ul>
<p>git push不会推送标签（tag），除非使用–tags选项:</p>
<ul>
<li>git push origin –tags</li>
</ul>
<h3 id="Frequently-used"><a href="#Frequently-used" class="headerlink" title="Frequently used"></a>Frequently used</h3><p>check last commit</p>
<ul>
<li>git show</li>
<li>git log -n1 -p</li>
</ul>
<p>check commit history for the feature branch</p>
<ul>
<li>git log develop..feature/REF-123</li>
</ul>
<p>This will show you all not pushed commits from all branches</p>
<ul>
<li>git log –branches –not –remotes</li>
</ul>
<p>and this must show you all your local commits</p>
<ul>
<li>git log origin/master..HEAD</li>
</ul>
<p>view the changes in a commit</p>
<ul>
<li>git show 877897e8a64043cc9277a859c616ec2e4ff57634</li>
</ul>
<p>To get the exact copy of remote develop branch, all local changes not pushed will be lost</p>
<ul>
<li>git fetch –all</li>
<li>git reset –hard origin/master</li>
</ul>
<p>To rename a branch</p>
<ul>
<li>git branch -m <oldname> <newname></newname></oldname></li>
<li>git branch -m <newname></newname></li>
</ul>
<p>stash</p>
<ul>
<li>git stash</li>
<li>git stash list</li>
<li>git stash apply</li>
<li>git stash apply stash@{2}</li>
<li>git stash drop stash@{2}</li>
<li>git stash show stash@{2}</li>
</ul>
<p>remove everything from the index/staging<br>– dry run</p>
<ul>
<li>git clean -n<br>– actually do the job</li>
<li>git clean -f<br>– do the job with both files and folders</li>
<li>git clean -xf</li>
</ul>
<p>remove all staged changes</p>
<ul>
<li>git reset HEAD – .</li>
</ul>
<p>remove all unstaged changes</p>
<ul>
<li>git checkout – .</li>
</ul>
<p>remove all untracked changes</p>
<ul>
<li>git clean -df</li>
</ul>
<p>garbage collection</p>
<ul>
<li>git gc</li>
</ul>
<p>Use the following command while being on “master”, to list merged branches:</p>
<ul>
<li>git branch –merged | grep -v “*“</li>
</ul>
<p>To get the commit into current branch</p>
<ul>
<li>git cherry-pick COMMIT_HASH</li>
</ul>
<h2 id="Best-Practice"><a href="#Best-Practice" class="headerlink" title="Best Practice"></a>Best Practice</h2><p>Each commit should be a single logical change. Don’t make several logical changes in one commit.<br>Don’t split a single logical change into several commits.</p>
<p>git commit –amend</p>
<h4 id="Git-commit-message-format"><a href="#Git-commit-message-format" class="headerlink" title="Git commit message format"></a>Git commit message format</h4><p><a href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html" target="_blank" rel="noopener">guide</a></p>
<h2 id="Use-different-SSH-keys-for-multiple-Bitbucket-accounts"><a href="#Use-different-SSH-keys-for-multiple-Bitbucket-accounts" class="headerlink" title="Use different SSH keys for multiple Bitbucket accounts"></a>Use different SSH keys for multiple Bitbucket accounts</h2><p><a href="https://developer.atlassian.com/blog/2016/04/different-ssh-keys-multiple-bitbucket-accounts/" target="_blank" rel="noopener">guide</a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a href="https://blog.coding.net/blog/principle-of-Git" target="_blank" rel="noopener">使用原理视角看 Git</a></li>
<li><a href="https://github.com/k88hudson/git-flight-rules" target="_blank" rel="noopener">git flight rules</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html" target="_blank" rel="noopener">Git远程操作详解</a></li>
<li><a href="https://www.atlassian.com/git/tutorials" target="_blank" rel="noopener">Atlassian Git Tutorials</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Development-Environment/">Development Environment</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-vue" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/24/vue/" class="article-date">
  <time datetime="2018-06-24T10:47:26.000Z" itemprop="datePublished">2018-06-24</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/24/vue/">Vue.js</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vue/">Vue</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-ruby" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/24/ruby/" class="article-date">
  <time datetime="2018-06-24T10:45:30.000Z" itemprop="datePublished">2018-06-24</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/24/ruby/">Ruby</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><ul>
<li>irb</li>
<li>rvm<ul>
<li>rvm list</li>
<li>rvm list known</li>
<li>rvm install 2.4.2</li>
<li>rvm remove 1.9.2</li>
<li>rvm 2.0.0 –default</li>
</ul>
</li>
<li>gem<ul>
<li>RubyGems is a package manager for the Ruby programming language that provides a standard format for distributing Ruby programs and libraries (in a self-contained format called a “gem”), a tool designed to easily manage the installation of gems, and a server for distributing them. </li>
</ul>
</li>
<li>bundler<ul>
<li>a bunch of gems defined in a file</li>
<li><a href="http://bundler.io/" target="_blank" rel="noopener">http://bundler.io/</a></li>
</ul>
</li>
</ul>
<h1 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is a comment</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 会在程序运行之前被调用</span></span><br><span class="line"><span class="keyword">BEGIN</span> &#123;</span><br><span class="line">   puts <span class="string">"初始化 Ruby 程序"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 会在程序的结尾被调用</span></span><br><span class="line"><span class="keyword">END</span> &#123;</span><br><span class="line">   puts <span class="string">"停止 Ruby 程序"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># In Ruby, (almost) everything is an object.</span></span><br><span class="line"><span class="comment"># This includes numbers…</span></span><br><span class="line"><span class="number">3</span>.<span class="keyword">class</span> <span class="comment">#=&gt; Integer</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># …strings…</span></span><br><span class="line"><span class="string">"Hello"</span>.<span class="keyword">class</span> <span class="comment">#=&gt; String</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># …even methods!</span></span><br><span class="line"><span class="string">"Hello"</span>.method(<span class="symbol">:class</span>).<span class="keyword">class</span> <span class="comment">#=&gt; Method</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Some basic arithmetic</span></span><br><span class="line"><span class="number">1</span> + <span class="number">1</span> <span class="comment">#=&gt; 2</span></span><br><span class="line"><span class="number">8</span> - <span class="number">1</span> <span class="comment">#=&gt; 7</span></span><br><span class="line"><span class="number">10</span> * <span class="number">2</span> <span class="comment">#=&gt; 20</span></span><br><span class="line"><span class="number">35</span> / <span class="number">5</span> <span class="comment">#=&gt; 7</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">5</span> <span class="comment">#=&gt; 32</span></span><br><span class="line"><span class="number">5</span> % <span class="number">3</span> <span class="comment">#=&gt; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Bitwise operators</span></span><br><span class="line"><span class="number">3</span> &amp; <span class="number">5</span> <span class="comment">#=&gt; 1</span></span><br><span class="line"><span class="number">3</span> <span class="params">| 5 #=&gt; 7</span></span><br><span class="line"><span class="params">3 ^ 5 #=&gt; 6</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arithmetic is just syntactic sugar</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> calling a method on an object</span></span><br><span class="line"><span class="params">1.+(3) #=&gt; 4</span></span><br><span class="line"><span class="params">10.* 5 #=&gt; 50</span></span><br><span class="line"><span class="params">100.methods.<span class="keyword">include</span>?(:/) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Special values are objects</span></span><br><span class="line"><span class="params"><span class="literal">nil</span> # equivalent to null <span class="keyword">in</span> other languages</span></span><br><span class="line"><span class="params"><span class="literal">true</span> # truth</span></span><br><span class="line"><span class="params"><span class="literal">false</span> # falsehood</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="literal">nil</span>.<span class="keyword">class</span> #=&gt; NilClass</span></span><br><span class="line"><span class="params"><span class="literal">true</span>.<span class="keyword">class</span> #=&gt; TrueClass</span></span><br><span class="line"><span class="params"><span class="literal">false</span>.<span class="keyword">class</span> #=&gt; FalseClass</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Equality</span></span><br><span class="line"><span class="params">1 == 1 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">2 == 1 #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Inequality</span></span><br><span class="line"><span class="params">1 != 1 #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">2 != 1 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># apart from <span class="literal">false</span> itself, <span class="literal">nil</span> is the only other 'falsey' value</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">!!<span class="literal">nil</span>   #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">!!<span class="literal">false</span> #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">!!0     #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">!!""    #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># More comparisons</span></span><br><span class="line"><span class="params">1 &lt; 10 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">1 &gt; 10 #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">2 &lt;= 2 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">2 &gt;= 2 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Combined comparison operator (returns `1` <span class="keyword">when</span> the first argument is greater, </span></span><br><span class="line"><span class="params"># `-1` <span class="keyword">when</span> the second argument is greater, <span class="keyword">and</span> `0` otherwise)</span></span><br><span class="line"><span class="params">1 &lt;=&gt; 10 #=&gt; -1</span></span><br><span class="line"><span class="params">10 &lt;=&gt; 1 #=&gt; 1</span></span><br><span class="line"><span class="params">1 &lt;=&gt; 1 #=&gt; 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">1 == 1.0 #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">1.eql?(1.0) #=&gt; <span class="literal">false</span> 如果接收器和参数具有相同的类型和相等的值，则返回 <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">aObj == bObj #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">a.equal?(bObj) #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params">a.equal?(aObj) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Logical operators</span></span><br><span class="line"><span class="params"><span class="literal">true</span> &amp;&amp; <span class="literal">false</span> #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"><span class="literal">true</span> |</span><span class="params">| <span class="literal">false</span> #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">!<span class="literal">true</span> #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># There are alternate versions of the logical operators with much lower</span></span><br><span class="line"><span class="params"># precedence. These are meant to be used as flow-control constructs to chain</span></span><br><span class="line"><span class="params"># statements together <span class="keyword">until</span> one of them returns <span class="literal">true</span> <span class="keyword">or</span> <span class="literal">false</span>.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># `do_something_else` only called <span class="keyword">if</span> `do_something` succeeds.</span></span><br><span class="line"><span class="params">do_something() <span class="keyword">and</span> do_something_else()</span></span><br><span class="line"><span class="params"># `log_error` only called <span class="keyword">if</span> `do_something` fails.</span></span><br><span class="line"><span class="params">do_something() <span class="keyword">or</span> log_error()</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># String interpolation</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">placeholder = 'use string interpolation'</span></span><br><span class="line"><span class="params">"I can #&#123;placeholder&#125; <span class="keyword">when</span> using double quoted strings"</span></span><br><span class="line"><span class="params">#=&gt; "I can use string interpolation <span class="keyword">when</span> using double quoted strings"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># You can combine strings using `+`, but <span class="keyword">not</span> with other types</span></span><br><span class="line"><span class="params">'hello ' + 'world'  #=&gt; "hello world"</span></span><br><span class="line"><span class="params">'hello ' + 3 #=&gt; TypeError: can't convert Fixnum into String</span></span><br><span class="line"><span class="params">'hello ' + 3.to_s #=&gt; "hello 3"</span></span><br><span class="line"><span class="params">"hello #&#123;3&#125;" #=&gt; "hello 3"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Combine strings <span class="keyword">and</span> operators</span></span><br><span class="line"><span class="params">'hello ' * 3 #=&gt; "hello hello hello "</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Append to string</span></span><br><span class="line"><span class="params">'hello' &lt;&lt; ' world' #=&gt; "hello world"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># print to the output with a newline at the <span class="keyword">end</span></span></span><br><span class="line"><span class="params">puts "I'm printing!"</span></span><br><span class="line"><span class="params">#=&gt; I'm printing!</span></span><br><span class="line"><span class="params">#=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># print to the output without a newline</span></span><br><span class="line"><span class="params">print "I'm printing!"</span></span><br><span class="line"><span class="params">#=&gt; I'm printing! =&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># here document</span></span><br><span class="line"><span class="params">print &lt;&lt;EOF</span></span><br><span class="line"><span class="params">    This is how you create a mulitple</span></span><br><span class="line"><span class="params">    line string. Anything inbetween is</span></span><br><span class="line"><span class="params">    part of the string.</span></span><br><span class="line"><span class="params">EOF</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables</span></span><br><span class="line"><span class="params">x = 25 #=&gt; 25</span></span><br><span class="line"><span class="params">x #=&gt; 25</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Note that assignment returns the value assigned</span></span><br><span class="line"><span class="params"># This means you can <span class="keyword">do</span> multiple assignment:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">x = y = 10 #=&gt; 10</span></span><br><span class="line"><span class="params">x #=&gt; 10</span></span><br><span class="line"><span class="params">y #=&gt; 10</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">a, b, c = 10, 20, 30</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">a, b = b, c</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># By convention, use snake_case <span class="keyword">for</span> variable names</span></span><br><span class="line"><span class="params">snake_case = <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Use descriptive variable names</span></span><br><span class="line"><span class="params">path_to_project_root = '/good/name/'</span></span><br><span class="line"><span class="params">m = '/bad/name/'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Symbols are immutable, reusable constants represented internally by an</span></span><br><span class="line"><span class="params"># integer value. They're often used instead of strings to efficiently convey</span></span><br><span class="line"><span class="params"># specific, meaningful values</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">:pending.<span class="keyword">class</span> #=&gt; Symbol</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status = :pending</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status == :pending #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status == 'pending' #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status == :approved #=&gt; <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Strings can be converted into symbols <span class="keyword">and</span> vice versa:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">status.to_s #=&gt; "pending"</span></span><br><span class="line"><span class="params">"argon".to_sym #=&gt; :argon</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arrays</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># This is an array</span></span><br><span class="line"><span class="params">array = [1, 2, 3, 4, 5] #=&gt; [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arrays can contain different types of items</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">[1, 'hello', <span class="literal">false</span>] #=&gt; [1, "hello", <span class="literal">false</span>]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Arrays can be indexed</span></span><br><span class="line"><span class="params"># From the front</span></span><br><span class="line"><span class="params">array[0] #=&gt; 1</span></span><br><span class="line"><span class="params">array.first #=&gt; 1</span></span><br><span class="line"><span class="params">array[12] #=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Like arithmetic, [var] access</span></span><br><span class="line"><span class="params"># is just syntactic sugar</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> calling a method [] on an object</span></span><br><span class="line"><span class="params">array.[] 0 #=&gt; 1</span></span><br><span class="line"><span class="params">array.[] 12 #=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># From the <span class="keyword">end</span></span></span><br><span class="line"><span class="params">array[-1] #=&gt; 5</span></span><br><span class="line"><span class="params">array.last #=&gt; 5</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># With a start index <span class="keyword">and</span> length</span></span><br><span class="line"><span class="params">array[2, 3] #=&gt; [3, 4, 5]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Reverse an Array</span></span><br><span class="line"><span class="params">a = [1,2,3]</span></span><br><span class="line"><span class="params">a.reverse! #=&gt; [3,2,1]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Or with a range</span></span><br><span class="line"><span class="params">array[1..3] #=&gt; [2, 3, 4]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Add to an array like this</span></span><br><span class="line"><span class="params">array &lt;&lt; 6 #=&gt; [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="params"># Or like this</span></span><br><span class="line"><span class="params">array.push(6) #=&gt; [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Check <span class="keyword">if</span> an item exists <span class="keyword">in</span> an array</span></span><br><span class="line"><span class="params">array.<span class="keyword">include</span>?(1) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Hashes are Ruby's primary dictionary with key/value pairs.</span></span><br><span class="line"><span class="params"># Hashes are denoted with curly braces:</span></span><br><span class="line"><span class="params">hash = &#123; 'color' =&gt; 'green', 'number' =&gt; 5 &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">hash.keys #=&gt; ['color', 'number']</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Hashes can be quickly looked up by key:</span></span><br><span class="line"><span class="params">hash['color'] #=&gt; 'green'</span></span><br><span class="line"><span class="params">hash['number'] #=&gt; 5</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Asking a hash <span class="keyword">for</span> a key that doesn't exist returns <span class="literal">nil</span>:</span></span><br><span class="line"><span class="params">hash['nothing here'] #=&gt; <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># When using symbols <span class="keyword">for</span> keys <span class="keyword">in</span> a hash, you can use this alternate syntax:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">new_hash = &#123; defcon: 3, action: <span class="literal">true</span> &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">new_hash.keys #=&gt; [:defcon, :action]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Check existence of keys <span class="keyword">and</span> values <span class="keyword">in</span> hash</span></span><br><span class="line"><span class="params">new_hash.key?(:defcon) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params">new_hash.value?(3) #=&gt; <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Tip: Both Arrays <span class="keyword">and</span> Hashes are Enumerable</span></span><br><span class="line"><span class="params"># They share a lot of useful methods such as each, map, count, <span class="keyword">and</span> more</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Control structures</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">if</span> <span class="literal">true</span></span></span><br><span class="line"><span class="params">  '<span class="keyword">if</span> statement'</span></span><br><span class="line"><span class="params"><span class="keyword">elsif</span> <span class="literal">false</span></span></span><br><span class="line"><span class="params">  '<span class="keyword">else</span> <span class="keyword">if</span>, optional'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  '<span class="keyword">else</span>, also optional'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># In Ruby, traditional `<span class="keyword">for</span>` loops aren't very common. Instead, these </span></span><br><span class="line"><span class="params"># basic loops are implemented using enumerable, which hinges on `each`:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">(1..5).each <span class="keyword">do</span> |</span>counter<span class="params">|</span></span><br><span class="line"><span class="params">  puts "iteration #&#123;counter&#125;"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Which is roughly equivalent to this, which is unusual to see <span class="keyword">in</span> Ruby:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">for</span> counter <span class="keyword">in</span> 1..5</span></span><br><span class="line"><span class="params">  puts "iteration #&#123;counter&#125;"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The `<span class="keyword">do</span> |</span>variable<span class="params">| ... <span class="keyword">end</span>` construct above is called a “block”. Blocks are similar</span></span><br><span class="line"><span class="params"># to lambdas, anonymous functions <span class="keyword">or</span> closures <span class="keyword">in</span> other programming languages. They can</span></span><br><span class="line"><span class="params"># be passed around as objects, called, <span class="keyword">or</span> attached as methods. </span></span><br><span class="line"><span class="params">#</span></span><br><span class="line"><span class="params"># The "each" method of a range runs the block once <span class="keyword">for</span> each element of the range.</span></span><br><span class="line"><span class="params"># The block is passed a counter as a parameter.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># You can also surround blocks <span class="keyword">in</span> curly brackets:</span></span><br><span class="line"><span class="params">(1..5).each &#123; |</span>counter<span class="params">| puts "iteration #&#123;counter&#125;" &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The contents of data structures can also be iterated using each.</span></span><br><span class="line"><span class="params">array.each <span class="keyword">do</span> |</span>element<span class="params">|</span></span><br><span class="line"><span class="params">  puts "#&#123;element&#125; is part of the array"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">hash.each <span class="keyword">do</span> |</span>key, value<span class="params">|</span></span><br><span class="line"><span class="params">  puts "#&#123;key&#125; is #&#123;value&#125;"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># If you still need an index you can use "each_with_index" <span class="keyword">and</span> define an index</span></span><br><span class="line"><span class="params"># variable</span></span><br><span class="line"><span class="params">array.each_with_index <span class="keyword">do</span> |</span>element, index<span class="params">|</span></span><br><span class="line"><span class="params">  puts "#&#123;element&#125; is number #&#123;index&#125; <span class="keyword">in</span> the array"</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">counter = 1</span></span><br><span class="line"><span class="params"><span class="keyword">while</span> counter &lt;= 5 <span class="keyword">do</span></span></span><br><span class="line"><span class="params">  puts "iteration #&#123;counter&#125;"</span></span><br><span class="line"><span class="params">  counter += 1</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">#=&gt; iteration 1</span></span><br><span class="line"><span class="params">#=&gt; iteration 2</span></span><br><span class="line"><span class="params">#=&gt; iteration 3</span></span><br><span class="line"><span class="params">#=&gt; iteration 4</span></span><br><span class="line"><span class="params">#=&gt; iteration 5</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># There are a bunch of other helpful looping functions <span class="keyword">in</span> Ruby,</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> example "map", "reduce", "inject", the list goes on. Map,</span></span><br><span class="line"><span class="params"># <span class="keyword">for</span> instance, takes the array it's looping over, does something</span></span><br><span class="line"><span class="params"># to it as <span class="keyword">defined</span> <span class="keyword">in</span> your block, <span class="keyword">and</span> returns an entirely new array.</span></span><br><span class="line"><span class="params">array = [1,2,3,4,5]</span></span><br><span class="line"><span class="params">doubled = array.map <span class="keyword">do</span> |</span>element<span class="params">|</span></span><br><span class="line"><span class="params">  element * 2</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">puts doubled</span></span><br><span class="line"><span class="params">#=&gt; [2,4,6,8,10]</span></span><br><span class="line"><span class="params">puts array</span></span><br><span class="line"><span class="params">#=&gt; [1,2,3,4,5]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">grade = 'B'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">case</span> grade</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'A'</span></span><br><span class="line"><span class="params">  puts 'Way to go kiddo'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'B'</span></span><br><span class="line"><span class="params">  puts 'Better luck <span class="keyword">next</span> time'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'C'</span></span><br><span class="line"><span class="params">  puts 'You can <span class="keyword">do</span> better'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'D'</span></span><br><span class="line"><span class="params">  puts 'Scraping through'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 'F'</span></span><br><span class="line"><span class="params">  puts 'You failed!'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  puts 'Alternative grading system, eh?'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">#=&gt; "Better luck <span class="keyword">next</span> time"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># cases can also use ranges</span></span><br><span class="line"><span class="params">grade = 82</span></span><br><span class="line"><span class="params"><span class="keyword">case</span> grade</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 90..100</span></span><br><span class="line"><span class="params">  puts 'Hooray!'</span></span><br><span class="line"><span class="params"><span class="keyword">when</span> 80...90</span></span><br><span class="line"><span class="params">  puts 'OK job'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  puts 'You failed!'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params">#=&gt; "OK job"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># exception handling:</span></span><br><span class="line"><span class="params"><span class="keyword">begin</span></span></span><br><span class="line"><span class="params">  # code here that might raise an exception</span></span><br><span class="line"><span class="params">  raise NoMemoryError, 'You ran out of memory.'</span></span><br><span class="line"><span class="params"><span class="keyword">rescue</span> NoMemoryError =&gt; exception_variable</span></span><br><span class="line"><span class="params">  puts 'NoMemoryError was raised', exception_variable</span></span><br><span class="line"><span class="params"><span class="keyword">rescue</span> RuntimeError =&gt; other_exception_variable</span></span><br><span class="line"><span class="params">  puts 'RuntimeError was raised now'</span></span><br><span class="line"><span class="params"><span class="keyword">else</span></span></span><br><span class="line"><span class="params">  puts 'This runs <span class="keyword">if</span> no exceptions were thrown at all'</span></span><br><span class="line"><span class="params"><span class="keyword">ensure</span></span></span><br><span class="line"><span class="params">  puts 'This code always runs no matter what'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Methods</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def double(x)</span></span><br><span class="line"><span class="params">  x * 2</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Methods (<span class="keyword">and</span> blocks) implicitly <span class="keyword">return</span> the value of the last statement</span></span><br><span class="line"><span class="params">double(2) #=&gt; 4</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Parentheses are optional where the interpretation is unambiguous</span></span><br><span class="line"><span class="params">double 3 #=&gt; 6</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">double double 3 #=&gt; 12</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def sum(x, y)</span></span><br><span class="line"><span class="params">  x + y</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Method arguments are separated by a comma</span></span><br><span class="line"><span class="params">sum 3, 4 #=&gt; 7</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">sum sum(3, 4), 5 #=&gt; 12</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># <span class="keyword">yield</span></span></span><br><span class="line"><span class="params"># All methods have an implicit, optional block parameter</span></span><br><span class="line"><span class="params"># it can be called with the '<span class="keyword">yield</span>' keyword</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def surround</span></span><br><span class="line"><span class="params">  puts '&#123;'</span></span><br><span class="line"><span class="params">  <span class="keyword">yield</span></span></span><br><span class="line"><span class="params">  puts '&#125;'</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">surround &#123; puts 'hello world' &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># &#123;</span></span><br><span class="line"><span class="params"># hello world</span></span><br><span class="line"><span class="params"># &#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Blocks can be converted into a `proc` object, which wraps the block </span></span><br><span class="line"><span class="params"># <span class="keyword">and</span> allows it to be passed to another method, bound to a different scope,</span></span><br><span class="line"><span class="params"># <span class="keyword">or</span> manipulated otherwise. This is most common <span class="keyword">in</span> method parameter lists,</span></span><br><span class="line"><span class="params"># where you frequently see a trailing `&amp;block` parameter that will accept </span></span><br><span class="line"><span class="params"># the block, <span class="keyword">if</span> one is given, <span class="keyword">and</span> convert it to a `Proc`. The naming here is</span></span><br><span class="line"><span class="params"># convention; it would work just as well with `&amp;pineapple`:</span></span><br><span class="line"><span class="params">def guests(&amp;block)</span></span><br><span class="line"><span class="params">  block.<span class="keyword">class</span> #=&gt; Proc</span></span><br><span class="line"><span class="params">  block.call(4)</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The `call` method on the Proc is similar to calling `<span class="keyword">yield</span>` <span class="keyword">when</span> a block is </span></span><br><span class="line"><span class="params"># present. The arguments passed to `call` will be forwarded to the block as arugments:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">guests &#123; |</span>n<span class="params">| "You have #&#123;n&#125; guests." &#125;</span></span><br><span class="line"><span class="params"># =&gt; "You have 4 guests."</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># You can pass a list of arguments, which will be converted into an array</span></span><br><span class="line"><span class="params"># That's what splat operator ("*") is <span class="keyword">for</span></span></span><br><span class="line"><span class="params">def guests(*array)</span></span><br><span class="line"><span class="params">  array.each &#123; |</span>guest<span class="params">| puts guest &#125;</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Destructuring</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Ruby will automatically destrucure arrays on assignment to multiple variables:</span></span><br><span class="line"><span class="params">a, b, c = [1, 2, 3]</span></span><br><span class="line"><span class="params">a #=&gt; 1</span></span><br><span class="line"><span class="params">b #=&gt; 2</span></span><br><span class="line"><span class="params">c #=&gt; 3</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># In some cases, you will want to use the splat operator: `*` to prompt destructuring</span></span><br><span class="line"><span class="params"># of an array into a list:</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">ranked_competitors = ["John", "Sally", "Dingus", "Moe", "Marcy"]</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">def best(first, second, third)</span></span><br><span class="line"><span class="params">  puts "Winners are #&#123;first&#125;, #&#123;second&#125;, <span class="keyword">and</span> #&#123;third&#125;."</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">best *ranked_competitors.first(3) #=&gt; Winners are John, Sally, <span class="keyword">and</span> Dingus.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># The splat operator can also be used <span class="keyword">in</span> parameters:</span></span><br><span class="line"><span class="params">def best(first, second, third, *others)</span></span><br><span class="line"><span class="params">  puts "Winners are #&#123;first&#125;, #&#123;second&#125;, <span class="keyword">and</span> #&#123;third&#125;."</span></span><br><span class="line"><span class="params">  puts "There were #&#123;others.count&#125; other participants."</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">best *ranked_competitors </span></span><br><span class="line"><span class="params">#=&gt; Winners are John, Sally, <span class="keyword">and</span> Dingus.</span></span><br><span class="line"><span class="params">#=&gt; There were 2 other participants.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># By convention, all methods that <span class="keyword">return</span> booleans <span class="keyword">end</span> with a question mark</span></span><br><span class="line"><span class="params">5.even? # <span class="literal">false</span></span></span><br><span class="line"><span class="params">5.odd? # <span class="literal">true</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># And <span class="keyword">if</span> a method ends with an exclamation mark, it does something destructive</span></span><br><span class="line"><span class="params"># like mutate the receiver. Many methods have a ! version to make a change, <span class="keyword">and</span></span></span><br><span class="line"><span class="params"># a non-! version to just <span class="keyword">return</span> a new changed version</span></span><br><span class="line"><span class="params">company_name = "Dunder Mifflin"</span></span><br><span class="line"><span class="params">company_name.upcase #=&gt; "DUNDER MIFFLIN"</span></span><br><span class="line"><span class="params">company_name #=&gt; "Dunder Mifflin"</span></span><br><span class="line"><span class="params">company_name.upcase! # we're mutating company_name this time!</span></span><br><span class="line"><span class="params">company_name #=&gt; "DUNDER MIFFLIN"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Define a <span class="keyword">class</span> with the <span class="keyword">class</span> keyword</span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Human</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # A <span class="keyword">class</span> variable. It is shared by all instances of this <span class="keyword">class</span>.</span></span><br><span class="line"><span class="params">  @@species = 'H. sapiens'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Basic initializer</span></span><br><span class="line"><span class="params">  def initialize(name, age = 0)</span></span><br><span class="line"><span class="params">    # Assign the argument to the "name" instance variable <span class="keyword">for</span> the instance</span></span><br><span class="line"><span class="params">    @name = name</span></span><br><span class="line"><span class="params">    # If no age given, we will fall back to the default <span class="keyword">in</span> the arguments list.</span></span><br><span class="line"><span class="params">    @age = age</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Basic setter method</span></span><br><span class="line"><span class="params">  def name=(name)</span></span><br><span class="line"><span class="params">    @name = name</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Basic getter method</span></span><br><span class="line"><span class="params">  def name</span></span><br><span class="line"><span class="params">    @name</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # The above functionality can be encapsulated using the <span class="keyword">attr_accessor</span> method as follows</span></span><br><span class="line"><span class="params">  <span class="keyword">attr_accessor</span> :name</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # Getter/setter methods can also be created individually like this</span></span><br><span class="line"><span class="params">  <span class="keyword">attr_reader</span> :name</span></span><br><span class="line"><span class="params">  <span class="keyword">attr_writer</span> :name</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  # A <span class="keyword">class</span> method uses <span class="keyword">self</span> to distinguish from instance methods.</span></span><br><span class="line"><span class="params">  # It can only be called on the <span class="keyword">class</span>, <span class="keyword">not</span> an instance.</span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.say(msg)</span></span><br><span class="line"><span class="params">    puts msg</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def species</span></span><br><span class="line"><span class="params">    @@species</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Instantiate a <span class="keyword">class</span></span></span><br><span class="line"><span class="params">jim = Human.new('Jim Halpert')</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">dwight = Human.new('Dwight K. Schrute')</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Let's call a couple of methods</span></span><br><span class="line"><span class="params">jim.species #=&gt; "H. sapiens"</span></span><br><span class="line"><span class="params">jim.name #=&gt; "Jim Halpert"</span></span><br><span class="line"><span class="params">jim.name = "Jim Halpert II" #=&gt; "Jim Halpert II"</span></span><br><span class="line"><span class="params">jim.name #=&gt; "Jim Halpert II"</span></span><br><span class="line"><span class="params">dwight.species #=&gt; "H. sapiens"</span></span><br><span class="line"><span class="params">dwight.name #=&gt; "Dwight K. Schrute"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Call the <span class="keyword">class</span> method</span></span><br><span class="line"><span class="params">Human.say('Hi') #=&gt; "Hi"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variable's scopes are <span class="keyword">defined</span> by the way we name them.</span></span><br><span class="line"><span class="params"># Variables that start with $ have global scope</span></span><br><span class="line"><span class="params">$var = "I'm a global var"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? $var #=&gt; "global-variable"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables that start with @ have instance scope</span></span><br><span class="line"><span class="params">@var = "I'm an instance var"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? @var #=&gt; "instance-variable"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables that start with @@ have <span class="keyword">class</span> scope</span></span><br><span class="line"><span class="params">@@var = "I'm a <span class="keyword">class</span> var"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? @@var #=&gt; "<span class="keyword">class</span> variable"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Variables that start with a capital letter are constants</span></span><br><span class="line"><span class="params">Var = "I'm a constant"</span></span><br><span class="line"><span class="params"><span class="keyword">defined</span>? Var #=&gt; "constant"</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Class is also an object <span class="keyword">in</span> ruby. So <span class="keyword">class</span> can have instance variables.</span></span><br><span class="line"><span class="params"># Class variable is shared among the <span class="keyword">class</span> <span class="keyword">and</span> all of its descendants.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># base <span class="keyword">class</span></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Human</span></span><br><span class="line"><span class="params">  @@foo = 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.foo</span></span><br><span class="line"><span class="params">    @@foo</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.foo=(value)</span></span><br><span class="line"><span class="params">    @@foo = value</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># derived <span class="keyword">class</span></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Worker &lt; Human</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Human.foo # 0</span></span><br><span class="line"><span class="params">Worker.foo # 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Human.foo = 2 # 2</span></span><br><span class="line"><span class="params">Worker.foo # 2</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Class instance variable is <span class="keyword">not</span> shared by the <span class="keyword">class</span>'s descendants.</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Human</span></span><br><span class="line"><span class="params">  @bar = 0</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.bar</span></span><br><span class="line"><span class="params">    @bar</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.bar=(value)</span></span><br><span class="line"><span class="params">    @bar = value</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Doctor &lt; Human</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Human.bar # 0</span></span><br><span class="line"><span class="params">Doctor.bar # <span class="literal">nil</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">module</span> ModuleExample</span></span><br><span class="line"><span class="params">  def foo</span></span><br><span class="line"><span class="params">    'foo'</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Including modules binds their methods to the <span class="keyword">class</span> instances</span></span><br><span class="line"><span class="params"># Extending modules binds their methods to the <span class="keyword">class</span> itself</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Person</span></span><br><span class="line"><span class="params">  <span class="keyword">include</span> ModuleExample</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Book</span></span><br><span class="line"><span class="params">  extend ModuleExample</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Person.foo     # =&gt; NoMethodError: undefined method `foo' <span class="keyword">for</span> Person:Class</span></span><br><span class="line"><span class="params">Person.new.foo # =&gt; 'foo'</span></span><br><span class="line"><span class="params">Book.foo       # =&gt; 'foo'</span></span><br><span class="line"><span class="params">Book.new.foo   # =&gt; NoMethodError: undefined method `foo'</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"># Callbacks are executed <span class="keyword">when</span> including <span class="keyword">and</span> extending a <span class="keyword">module</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">module</span> ConcernExample</span></span><br><span class="line"><span class="params">  def <span class="keyword">self</span>.included(base)</span></span><br><span class="line"><span class="params">    base.extend(ClassMethods)</span></span><br><span class="line"><span class="params">    base.send(:<span class="keyword">include</span>, InstanceMethods)</span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  <span class="keyword">module</span> ClassMethods</span></span><br><span class="line"><span class="params">    def bar</span></span><br><span class="line"><span class="params">      'bar'</span></span><br><span class="line"><span class="params">    <span class="keyword">end</span></span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">  <span class="keyword">module</span> InstanceMethods</span></span><br><span class="line"><span class="params">    def qux</span></span><br><span class="line"><span class="params">      'qux'</span></span><br><span class="line"><span class="params">    <span class="keyword">end</span></span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">class</span> Something</span></span><br><span class="line"><span class="params">  <span class="keyword">include</span> ConcernExample</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params">Something.bar     # =&gt; 'bar'</span></span><br><span class="line"><span class="params">Something.qux     # =&gt; NoMethodError: undefined method `qux'</span></span><br><span class="line"><span class="params">Something.new.bar # =&gt; NoMethodError: undefined method `bar'</span></span><br><span class="line"><span class="params">Something.new.qux # =&gt; 'qux'</span></span><br></pre></td></tr></table></figure>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://learnxinyminutes.com/docs/ruby/" target="_blank" rel="noopener">Learn X in Y minutes</a></li>
</ol>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/RoR/">RoR</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-ruby-on-rails" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2018/06/23/ruby-on-rails/" class="article-date">
  <time datetime="2018-06-23T12:56:16.000Z" itemprop="datePublished">2018-06-23</time>
</a>
		</span>
		<span class="meta-elements author">Marvin Liu</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2018/06/23/ruby-on-rails/">Ruby on Rails</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h2 id="Development-Environment"><a href="#Development-Environment" class="headerlink" title="Development Environment"></a>Development Environment</h2><p>Follow <a href="https://ruby-china.org/wiki/install_ruby_guide" target="_blank" rel="noopener">this</a> guide.</p>
<h2 id="Philosohpy"><a href="#Philosohpy" class="headerlink" title="Philosohpy"></a>Philosohpy</h2><h3 id="Don’t-repeat-yourself"><a href="#Don’t-repeat-yourself" class="headerlink" title="Don’t repeat yourself"></a>Don’t repeat yourself</h3><h3 id="Convention-over-Configuration"><a href="#Convention-over-Configuration" class="headerlink" title="Convention over Configuration"></a>Convention over Configuration</h3><h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><ul>
<li>Model: 操作数据库</li>
<li>Controller: 把每个 http request 分发到对应的 Action( method) 来处理</li>
<li>View: 显示页面</li>
</ul>
<h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><p>config/routes.rb: <code>resources :users</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET  /users         index     显示 user的列表页</span><br><span class="line">GET  /users/new     new       显示 user的新建页面。</span><br><span class="line">GET  /users/3       show      显示id是3的user</span><br><span class="line">GET  /users/3/edit  edit      显示 user(id =3)的编辑页面。</span><br><span class="line">PUT  /users/3       update    对id = 3的user进行修改 （后面还会紧跟一大串的参数)</span><br><span class="line">POST /users         create    对users进行创建（后面也有一大堆参数)</span><br><span class="line">DELETE  /users/3    destroy   对 id=3的 user 进行删除操作。</span><br></pre></td></tr></table></figure>
<p>可以使用<code>$ rake routes</code>查看当前项目中所有的路由</p>
<h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><h3 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h3><h2 id="Database-Migration"><a href="#Database-Migration" class="headerlink" title="Database Migration"></a>Database Migration</h2>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/RoR/">RoR</a>
  </div>

			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rails/">Rails</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:superliuwr.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">SUPERLOG</a>
	</h1>
	<span class="copyright">
		&copy; 2018 Marvin Liu<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>